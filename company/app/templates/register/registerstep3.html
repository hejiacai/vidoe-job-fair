<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>发布职位</title>
<!–[if lt IE9]> 
<script src="{/version file='html5.js'/}"></script>
<![endif]–>
<link rel="stylesheet" type="text/css" href="{/version file='base.css'/}" />
<link rel="stylesheet" type="text/css" href="{/version file='icons.css'/}" />
<link rel="stylesheet" type="text/css" href="{/version file='comback.css'/}" />
<link rel="stylesheet" type="text/css" href="{/version file='v2-widge.css'/}" />
<link rel="stylesheet" type="text/css" href="{/version file='new_step.css'/}" />
<script type="text/javascript" language="javascript" src="{/version file='version.js'/}"></script>
<script type="text/javascript">
window.CONFIG = {
	HOST: '{/$siteurl.style/}',
    COMBOPATH: '/js/v2/'
}
</script>
<!--<script type="text/javascript" src="{/version file='hbjs.js,jquery.min.js,util.js,class.js,shape.js,event.js,aspect.js,attribute.js,cookie.js'/}"></script>-->
    <script type="text/javascript" src="{/version file='hbjs.js'/}"></script>
    <script type="text/javascript" src="{/version file='jquery.min.js'/}"></script>
    <script type="text/javascript" src="{/version file='util.js'/}"></script>
    <script type="text/javascript" src="{/version file='class.js'/}"></script>
    <script type="text/javascript" src="{/version file='shape.js'/}"></script>
    <script type="text/javascript" src="{/version file='shape.js'/}"></script>
    <script type="text/javascript" src="{/version file='event.js'/}"></script>
    <script type="text/javascript" src="{/version file='aspect.js'/}"></script>
    <script type="text/javascript" src="{/version file='attribute.js'/}"></script>
    <script type="text/javascript" src="{/version file='cookie.js'/}"></script>
<script type="text/javascript" src="{/version file='global.js'/}"></script>
<script type="text/javascript" src="//api.map.baidu.com/api?v=2.0&ak=33f9256a1a1ba5a80eb40f8ed45bce3c"></script>
<script type="text/javascript">
hbjs.loadJS('{/$siteurl.style/}/js/v2/cqjob/common.js');
</script>

<style type="text/css">
.section .mod{}
.section .mod h2{font-size:16px;height:35px;line-height:35px;border-bottom:1px solid #dadada;padding:0 0 0 20px;font-weight:bold;}
.mod .formMod .l{width:195px;}
.mod .formMod .r{width:750px;}
.mod .form{padding:20px 0 15px;}

.welMod .formChb{margin-left:0;}

.checkMod .tipTxt a{margin:0 10px 0 0;color:#666}

.formBtn{margin:10px 0 25px 201px;}

.mod .formMod .r .recTemp{display:block;line-height:30px;width:750px;}
.mod .formTextarea textarea.textarea{height:200px; width:600px; line-height:24px;}
.mod .JobCayMod .r .formChb b{font-weight:normal; line-height:30px; float:left; display:inline; font-size:12px;}

/*update mijing*/
.valid label{display: block;margin-top: 5px}
.valid label.gray9{color:#999}
.valid strong{color:#f60}
.valid .time{font-size:12px;margin-top: 5px;display:block}
.valid .time a{margin-left: 10px;color:#0099ff}
.valid .bggray{background-color: #eee;border-radius: 3px;padding:5px 10px 10px 10px;margin-top: 5px}
.not-enou{font-size:12px}
/*福利待遇及岗位特点样式*/
.flitem{display: inline-block;padding: 2px 10px;margin-right:10px;margin-top: 2px;color:#666;border:1px solid #ececec;line-height: 22px;border-radius: 2px;font-size:12px}
#selectedFea a { margin-top: 7px;display: inline-block;font-size:12px}
selectedReward a{margin-top: 7px;display: inline-block;font-size:12px}

.oppenWay{display:block; float:left;width:60px; height:30px; background:url("{/$siteurl.style/}/img/c/new_resume/open.png") -60px 0px no-repeat; margin-right:10px;}
.oppenWaycut{ background-position:0px 0px;}

/* 非会员-提示弹层 */
.bomb-alert{box-shadow:0px 0px 32px 5px #070002;color:#00a49f;border:0}
.bomb-alert .tit{background: url({/$siteurl.style/}/img/c/new_index/bobm-tit.jpg) no-repeat;height: 103px}
.bomb-alert .tit .close{display: block;float:right;width:18px;height: 19px;background: url({/$siteurl.style/}/img/c/new_index/close.png) no-repeat;margin:10px}
.bomb-alert .tit .close:hover{background-position: 0 -19px}
.bomb-alert .con{padding:25px 0 25px 25px;line-height: 25px}
.bomb-alert .con p{font-size:16px;font-weight:bold;margin-bottom: 10px}
.bomb-alert .con span{font-size:14px}
.bomb-alert .link{text-align: center;margin-top: 30px}
.bomb-alert .link .butn{font-size:16px;color:#fff;background-color: #fa9f02;height: 40px;padding:0 30px;line-height: 40px;border-radius: 20px;display: inline-block}
.bomb-alert .link .butn:hover{background-color: #fa8602}
.bomb-alert .link .iknow{font-size:14px;color:#ccc;margin-left: 20px}
.bomb-alert .link .iknow:hover{color:#a5a5a5}
.bomb-alert .ui_dialog_container{padding:0;}

/*================================= 流程引导 start ======================================*/

.box_step .title span{font-size:20px;color:#54728c;font-weight:bold;font-family:"微软雅黑";padding-left: 10px}
.box_step .title span i{border-left:4px solid #0ea5a0;height:20px;display: inline-block;float: left;margin-top: 6px}
.stop_list{margin-left: 143px;margin-bottom: 20px}
.stop_list li{float:left;width:200px;text-align: center}
.stop_list li span{display: inline-block;width:30px;height: 30px;background: url({/$siteurl.style/}/img/job/newjob/yuan.jpg) no-repeat;text-align: center;font-size:18px;color:#fff;font-weight:bold;float:left;font-family: arial}
.stop_list li em{display: inline-block;width:85px;height: 9px;background: url({/$siteurl.style/}/img/job/newjob/hr.jpg) no-repeat;float:left;margin-top: 12px}
.stop_list li .first span,.stop_list li .first em{float:right}
.stop_list li .text{font-size:14px;margin-top: 5px;color:#999}
.stop_list li.cur .text{color:#00bab1}
.stop_list li.cur span{background: url({/$siteurl.style/}/img/job/newjob/cur_yuan.jpg) no-repeat;}
.stop_list li.cur em{background: url({/$siteurl.style/}/img/job/newjob/cur_hr.jpg) no-repeat;}

/*================================= 流程引导 end ======================================*/
/*弹窗样式*/
.new-sign-pop{ text-align:left; padding:0px 18px 28px 18px;width:508px; overflow:hidden; background:#fff; margin:0 auto; font-family:"微软雅黑";}
.new-sign-pop-company-ver{  padding:0px 18px 28px 18px;overflow:hidden; background:#fff;font-family:"微软雅黑";}
.new-sign-tit{height:48px; color:#444; line-height:48px; border-bottom:1px dashed #e9e8e8; font-size:16px;}
.new-sign-tab tr th{ color:#999; text-indent:15px;font-size: 14px}
.new-sign-tab tr td{ text-indent:15px; color:#444; overflow:hidden;font-size: 14px}
.new-sign-tab tr td em{ color:#ff4141;}
.new-sign-tab tr.gray td{ background:#fafafa;}
.new-sign-char{ display:block; color:#999; font-size:12px; padding:12px 0 16px 0; text-indent:15px;}
.new-sign-btnx{overflow:hidden;font-size: 14px}
.new-sign-btnx a.sub-btn{ display:block;width:140px; height:40px; line-height:40px; text-align:center; color:#fff; background:#66bce4; border-radius:2px; float:left; margin-left:15px;font-size: 16px}
.new-sign-btnx span{ display:block; float:right; color:#999; line-height:40px;margin-right:15px}
.new-sign-btnx span a{ color:#4e92c4; padding-left:2px;}

.new-sign-popx{padding:15px 0 0 0; padding-bottom:0px; overflow:hidden; font-family:"微软雅黑";font-size:14px}
.new-sign-popx li{ color:#444; padding-bottom:20px;}
.new-sign-popx .name{display:block;margin-left: 70px}
.new-sign-popx li .dtit{display: inline-block;}
.new-sign-popx li input{ display:inline-block; vertical-align:middle;width:240px; height:34px; border:1px solid #cfcfcf; text-indent:10px; background:none;line-height: 34px;font-size:14px}
.new-sign-popx li a.present,.new-sign-popx li a.gray{width:120px; height:30px; background:#66bce4; color:#fff; text-align:center; line-height:30px; display:inline-block; margin-right:36px;border-radius:2px;}
.new-sign-popx li a.gray{ color:#999; background:#f0f0f0;margin-left:30px;margin-right:0px}
.new-sign-popx li a.code-btn{ display:inline-block;padding:0 15px;height:26px; border:1px solid #58cbe0; background:#58cbe0; vertical-align:middle; margin-left:20px;  #margin-left:51px;text-align:center; line-height:24px; color:#fff;}
.new-sign-popx li.gray2{ color:#999;}
.new-sign-popx li a.orange{ color:#ed7f5a; text-decoration:underline;}
.new-sign-pop-dialog .new-sign-pop{width:auto;}
.new-sign-tab tr td a{ display:inline-block;width:78px; height:26px; border:1px solid #22a2df; text-align:center; line-height:26px; text-indent:0px; border-radius:2px;font-size: 12px}
.pact-dialog .ui_dialog_container{padding:20px;line-height:20px;}
.formText label.txtLabel{top:6px}
</style>
</head>
<body id="body">

{/include file='./register/register_head.html' head_step=3/}

<form id="formjobadd" method="post" action="/register/jobAddDo/">
<input name="map_x" type="hidden" value="{/$map_x/}"/>
<input name="map_y" type="hidden" value="{/$map_y/}"/>
<div class="content" id="content">
	<section class="section">
    	<hgroup>
            <div class="mod">
                                
                <div class="step-tit"><a href="/licencevalidate/?step=4" class="login login-post">暂不发布职位</a>	<i class="icon-write icon-smile"></i>好啦，现在开始发布职位吧。</div>
                <p class="tit"><u></u><i></i>描述一下这个职位</p>
                <div class="form">
                    <!-- 招聘公司 -->
                    
                    <div class="formMod JobIndDrop checkMod">
                        <a id="jobsort" name="cal"></a>
                        <div class="l">职位类别<i>*</i></div>
                        <div class="r">
                        
                        	<div id="newJobsort" class="formText mutilpleSelectBox">
                                <b class="hbFntWes icon">&#xf03a;</b>
                                <ul class="label">
                                    {/foreach $jobsorts as $jobsortid=>$jobsort/}
                                    <li data-id="{/$jobsortid/}"><a href="javascript:">{/$jobsort['jobsort_name']/}<span class="close">×</span></a></li>
                                    {//foreach/}
                                </ul>
                                <input type ="hidden" name="main_jobsort" id="main_jobsort" value="">
                            </div>
                        
                            <!--<a href="javascript:void(0)" id="addHtml"  style="font-size: 12px;margin-top: 5px; float:left; padding-left:8px;">+添加次类别</a>-->
                            <span class="tipPos">
                                <span class="tipLay"></span>
                            </span>
                        </div>
                        <div class="clear"></div>
                    </div>
                     <div id="hidLastJobsort" class="formMod JobIndDrop checkMod" style="display:none;">
                        <a id="calling" name="cal"></a>
                        <div class="l">次要类别<i>&nbsp;</i></div>
                        <div class="r">
                            
                            <div id="nextJobsort" class="formText mutilpleSelectBox">
                                <b class="hbFntWes icon">&#xf03a;</b>
                                <ul class="label">
                                    {/foreach $expect_jobsort as $jobsortid=>$jobsort/}
                                    <li data-id="{/$jobsortid/}"><a href="javascript:">{/$jobsort['jobsort_name']/}<span class="close">×</span></a></li>
                                    {//foreach/}
                                </ul>
                                <input type ="hidden" name="next_jobsort"  id="next_jobsort" {/if count($jobsort_arr)>=2/}value='{/$jobsort_arr[1]/}'{//if/}>
                            </div>
                            
                           <a id="delHtml" href="javascript:void(0)" style="font-size: 12px;margin-top: 5px;margin-left:13px;display: inline-block">删除</a>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="formMod">
                        <div class="l">职位名称<i>*</i></div>
                        <div class="r">
                            <span class="formText">
                                <input type="text" style="width:235px;" value="" name="txtStation" id="txtStation" class="text"> &nbsp;  
                                <input id="jobType3" type="checkbox" name="radJobType" value="3">
                                <label for="jobType3">实习</label>
                                <input id="jobtype" type="hidden" name="radJobType" value="1">
                            </span>
                            <span class="tipPos">
                                <span class="tipLay"></span>
                             </span>
                        </div>
                        <div class="clear"></div>
                    </div>

                    <div class="formMod">
                        <div class="l">岗位级别<i>*</i></div>
                        <div class="r">
                        	<span id="jobLevelDrop" class="drop zindex"></span>
                            <span class="tipPos">
                                <span class="tipLay"></span>
                            </span>
                        </div>
                        <div class="clear"></div>
                    </div>

                    <div class="formMod">
                        <div class="l">招聘人数<i>*</i></div>
                        <div class="r">
                            <span class="formText">
                                <input type="text" name="txtQuantity" class="text" style="width:45px;">
                            </span>
                            <span class="tipTxt font14">人</span>
                            <span class="tipPos">
                                <span class="tipLay"></span>
                            </span>
                        </div>
                        <div class="clear"></div>
                    </div>
                        
                    <div class="formMod addressMod">
                        <div class="l">工作地点<i>*</i></div>
                        <div class="r" >
                            <div id="area"></div>
                            <span class="tipPos">
                                <span class="tipLay">
                                </span>
                             </span>
                            <span class="formText" style="margin:10px 0 0 0;clear:both;">
                                <input value="{/$company_address/}" name="txtAddInfo" type="text" style="width:425px;" id="addInfo" class="text watermark" watermark="详细地址描述，如：环球广场25楼汇博网">
                                <div id="searchResultPanel" style="border:1px solid #C0C0C0;width:150px;height:auto; display:none;"></div>
                            </span>
                            <p class="formMap" style="color: red; position: relative; font-size: 12px; margin: 5px 0px;">(请拖动图标在地图中标注上班地点)</p>
                            <span id="mapCon" class="formMap" style="width:650px;height:290px;">

                            </span>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                     <div class="formMod cashMod">
                        <div class="l">薪资待遇<i>*</i></div>
                        <div class="r">
                        	<ul id="x_salary_nav" class="x_salary">
                            	<li class="x_cura x_cur"><label><input value="0" type="radio" name="rd" class="x_radio" checked="checked">定额薪资</label></li>
                                <li class="x_cura"><label><input value="1" type="radio" name="rd" class="x_radio">底薪+提成</label></li>
                                <li style="display:none"><input type="checkbox" value="1" name="chkIsSalaryShow" id="xm" class="chb"><label for="xm">显示为面议</label></li>
                            </ul>
                            <!-----定额薪资---->
                            <div id="x_salaryBg" class="x_sbd">
                            <div class="x_salaryBg" style="display:block;">
                                <span id="salaryDrop1" class="drop formText zindex" style="z-index: 994;"></span>
                                <span class="tipTxt font14" style="margin-right:10px;">~</span>
                                <span id="salaryDrop1End" class="drop formText zindex" style="z-index: 993;"></span>
                                <span class="tipPos">
                                    <span class="tipLay">
                                    </span>
                                 </span>
                                <span class="tipTxt font14">元/月</span>
                                <span class="tipTxt" style="margin:0;width:400px;color:#999;clear:both;">薪资范围差不超过两倍，真实的薪资更利于提高招聘效果</span>
                                <div class="clear"></div>
                                <div id="salaryRefer" style="font-size: 14px;color: #999;border-left:1px solid #f1f1f1;font-family: 'Microsoft yahei';line-height: 25px;padding-top: 10px"></div>
                            </div>
                            <!-------底薪+提成-------->
                            <div class="x_salaryBg">
                            	<div class="x_sbg">
                                <div>
                                <span class="x_tipTxt">底薪：</span>
                                <span id="salaryDrop2" class="drop formText zindex" style="z-index: 994;"></span>
                                <span class="tipTxt font14" style="margin-right:10px;">~</span>
                                <span id="salaryDrop2End" class="drop formText zindex" style="z-index: 993;"></span>
                                <span class="tipPos">
                                    <span class="tipLay">
                                    </span>
                                 </span>
                                <span class="tipTxt font14">元/月</span>
                                <div class="clear"></div>
                                </div>
                                <div>
                                <span class="x_tipTxt2">平均收入（底薪+提成）：</span>
                                <span id="salaryDrop3" class="drop formText zindex" style="z-index: 994;"></span>
                                <span class="tipTxt font14" style="margin-right:10px;">~</span>
                                <span id="salaryDrop3End" class="drop formText zindex" style="z-index: 993;"></span>
                                <span class="tipPos">
                                    <span class="tipLay">
                                    </span>
                                 </span>
                                <span class="tipTxt font14">元/月</span>
                                <div class="clear"></div>
                                </div>
                                
                                <div class="clear"></div>
                                </div>
                                <span class="tipTxt" style="margin:0;width:400px;color:#999;clear:both;">薪资范围差不超过两倍，真实的薪资更利于提高招聘效果</span>
                                <div class="clear"></div>
                            </div>
                            	<div class="clear"></div>
                            </div>
                            
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="formMod">
                        <div class="l">岗位职责<i>*</i></div>
                        <div class="r">
                        	<span id="recommendContent" style="display:none;clear:both;" class="recTemp">模板：</span>
                            <span class="formTextarea">
                                <textarea class="textarea" name="txtContent" id="txtContent"></textarea>
                            </span>
                            <span class="tipPos">
                                <span class="tipLay">
                                </span>
                            </span>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="formMod">
                        <div class="l">福利待遇<i> </i></div>
                        <div class="r">
                        	<div id="selectedReward" class="dialogCont setWelfare">
                                {/if count($all_reward_data) > 0/}
                                {/foreach $all_reward_data as $reward/}
                                <a href="javascript:" data-name="hidDefaultReward"  {/if in_array($reward['reward_id'], $default_reward_arr)/} class="cur" {//if/} data-value="{/$reward['reward_id']/}">{/$reward['reward_name']/}<i class="hbIconMoon">&#xe0fb;</i></a>
                                {//foreach/}
                                {//if/}
                            </div>
                            <input type="hidden" value='{/$hidDefaultReward/}' id="hidDefaultReward" name="hidDefaultReward" />
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="formMod">
                        <div class="l">岗位特点<i> </i></div>
                        <div class="r">
                        	<div id="selectedFea" class="dialogCont setWelfare">
                                {/if count($all_fea_data) > 0/}
                                {/foreach $all_fea_data as $fea/}
                                <a href="javascript:" data-name="hidDefaultFea" data-value="{/$fea['feature_id']/}" >{/$fea['feature_name']/}<i class="hbIconMoon">&#xe0fb;</i></a>
                                {//foreach/}
                                {//if/}
                            </div>
                            <input type="hidden" value='{/$hidDefaultFea/}' id="hidDefaultFea" name="hidDefaultFea" />
                        </div>  
                        <div class="clear"></div>
                    </div>
                    <div class="formMod">
                        <div class="l">有效期<i>*</i></div>
                        <div class="r">
                            <span class="formText">
                                <input value="30" id="txtValidDays" name="txtValidDays" type="text" style="width:45px;" class="text">
                            </span>
                            <span class="tipTxt font14">天</span>
                            <span id="endTimeSpan" class="tipTxt font14" style="margin-left:20px;"></span>
                            <span class="tipPos">
                                <span class="tipLay">
                                </span>
                            </span>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <p class="tit"><u style="width:81%"></u><i></i>对求职者有什么需求</p>
                <div class="form">
                    <div class="formMod">
                        <div class="l">工作经验<i>*</i></div>
                        <div class="r">
                            <span id="workYearDrop" class="drop zindex"></span>
                            <span class="formChb"><input value="1" type="checkbox" name="chkNewGraduate" id="yjs" class="chb"><label for="yjs">可接受应届生</label></span>
                            <span class="tipPos">
                                <span class="tipLay">
                                </span>
                            </span>
                        </div>
                        <div class="clear"></div>
                    </div>


                    <div id="yjs_calling" class="formMod JobIndDrop checkMod" style="{/if $job.allow_graduate != 1/}display:none{//if/}">
                        <a id="professionalSort" name="cal"></a>
                        <div class="l">应届生专业<i></i></div>
                        <div class="r">
                            <div id="newProfessionalSort" class="formText mutilpleSelectBox">
                                <b class="hbFntWes icon">&#xf03a;</b>
                                <ul class="label">
                                </ul>
                                <input type ="hidden" name="main_professionalSort" id="main_professionalSort" value="">
                            </div>
                            <span class="tipPos" style="left:75px;"><span class="tipLay"></span></span>
                        </div>
                        <div class="clear"></div>
                    </div>



                    <div class="formMod">
                        <div class="l">最低学历<i>*</i></div>
                        <div class="r">
                            <span id="degreeDrop" class="drop zindex">
                            </span>
                            <span class="tipPos">
                                <span class="tipLay">
                                </span>
                            </span>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                    <div class="formMod">
                        <div class="l">性别要求<i>&nbsp;</i></div>
                        <div class="r">
                            <span id="sexDrop" class="drop zindex">
                            </span>
                            <span></span>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                    <div class="formMod ageMod">
                        <div class="l">年龄要求<i>&nbsp;</i></div>
                        <div class="r">
                            <span id="ageDrop1" class="drop zindex">
                            </span>
                            <span></span>
                            <span class="tipTxt font14" style="margin-right:5px;">-</span>
                            <span id="ageDrop2" class="drop zindex">
                            </span>
                            <span></span>
                            <span class="tipTxt font14">岁</span>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                    <div class="formMod">
                        <div class="l">语言要求<i>&nbsp;</i></div>
                        <div class="r">
                            <span id="languageDrop" class="drop zindex">
                            </span>
                            <span></span>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="formMod">
                        <div class="l">补充说明<i>&nbsp;</i></div>
                        <div class="r">
                        	<span id="recommendOtherNeed" style="display:none;" class="recTemp">模板：</span>
                            <span class="formTextarea">
                                <textarea name="txtOtherNeed" class="textarea" id="txtOtherNeed"></textarea>
                            </span>
                            <span class="tipPos">
                                <span class="tipLay">
                                </span>
                            </span>
                        </div>
                        <div class="clear"></div>
                    </div>
                </div>

                <div class="clearfix">
                	<p class="tit" style="float:left"><i></i>职位发布人</p>
                    <p style="float: left;padding-left: 15px;font-size:12px;padding-top: 15px" class="clearfix">
                        <select name="param_account_id" style="float:left;margin-top: 4px;min-width: 120px;height:30px">
                            {/foreach $company_account_info as $v/}
                            <option id="account_info_{/$v['account_id']/}" data-mobile="{/$v['mobile_phone']/}" data-link="{/$v['link_tel']/}" value="{/$v['account_id']/}" {/if $v['account_id'] == $job.account_id/}selected{//if/} > {/$v['user_id']/}</option>
                            {//foreach/}
                        </select>
                        <span class="formChb" style="color:#444;margin-top: 3px"><input  value="1" type="checkbox" name="param_allow_link" id="pa_allow_link" class="chb" checked="checked" ><label>允许在线沟通</label></span>
                    </p>

                </div>
				<p class="tit"><u style="width:89%"></u><i></i>联系方式</p>
                <div class="contactWay" style="padding-left: 123px;color:#6c6c6c;font-size:14px">
                    <p><input type="radio" class="radio" name="showLinkway" id="conW1" value="0" checked  /><label for="conW1" style="margin-left: 5px">不向求职者展示联系方式（不想受到骚扰）</label></p>
                    <p style="margin-top: 10px"><input type="radio" class="radio" name="showLinkway" id="conW2" value="1"  /><label for="conW2" style="margin-left: 5px">展示联系方式（愿意接受求职者咨询）</label></p>
                    <div class="contactWayLst" style="{/if $job.open_linkway != 1/}display:none;{//if/}background: #eee;border-radius: 3px;padding:15px;margin-top: 10px;line-height: 25px;font-size:12px;color:#333;margin-left: 20px">
                        <!--<p><input type="radio" class="radio" name="newLinkway" id="way1" value="0" {/if $job.self_linkway == 0 || empty($linkways) || count($linkways)<1/}checked="checked"{//if/} /><label for="way1">使用企业联系方式{/if !empty($linkman) && !empty($link_tel)/}（{/$linkman/} {/$link_tel/}）{//if/}</label></p>-->
                        <p style="{/if empty($company_account_info[$job.account_id]['mobile_phone'])/}display: none{//if/}"><input type="radio" class="radio" name="newLinkway" id="way1" value="4"   /><label  for="way1" style="margin-left: 5px">发布人手机号 <em id="u_moblie" style="margin-left: 15px">{/$company_account_info[$job.account_id]['mobile_phone']/}</em></label></p>
                        <p style="{/if empty($company_account_info[$job.account_id]['link_tel'])/}display: none{//if/}"><input type="radio" class="radio" name="newLinkway" id="way3" value="5" checked /><label  for="way1" style="margin-left: 5px">发布人办公电话<em id="u_tel" style="margin-left: 15px">{/$company_account_info[$job.account_id]['link_tel']/}</em></label></p>
                        <p><input type="radio" class="radio" name="newLinkway" id="way2" value="1"  /><label for="way2" style="margin-left: 5px">其他电话</label></p>
                        <div class="newContact" style="{/if $job.self_linkway != 1 || empty($linkways) || count($linkways)<1/}display:none;{//if/}">
                            <ul class="clearfix">
                                {/section name=link loop=$linkways/}
                                <li>
                                    <span class="formText">
                                        <input id="txtLinkMan{/$smarty.section.link.index+1/}" name="txtLinkMan{/$smarty.section.link.index+1/}" type="text" value="{/if $job.self_linkway == 1 && !empty($linkways) && count($linkways)>0/}{/$linkways[link].link_man/}{//if/}" style="width:120px;" class="text conPeople watermark {txtLinkManValidate:true}" watermark="输入电话号码">
                                    </span>
                                    <span class="formText" style="margin-left:10px;">
                                        <input id="txtLinkTel{/$smarty.section.link.index+1/}" name="txtLinkTel{/$smarty.section.link.index+1/}" type="text" value="{/if $job.self_linkway == 1 && !empty($linkways) && count($linkways)>0/}{/$linkways[link].linkman_tel/}{//if/}" style="width:80px;" class="text conPhone watermark {txtLinkTelValidate:true, tel:true}" watermark="分机号">
                                    </span>
                                    <span class="tipTxt" style="margin-left:10px;display: none"><a href="javascript:void(0);" onclick="jobAdd.addNewLinkWay(this);">增加</a>{/if $smarty.section.link.index!=0/}<a href="javascript:void(0);" onclick="jobAdd.delNewLinkWay(this);">删除</a>{//if/}</span>
                                    <span class="tipPos">
                                        <span class="tipLay">
                                        </span>
                                    </span>
                                </li>
                                {/sectionelse/}
                                <li>
                                    <span class="formText">
                                        <input id="txtLinkMan1" disabled="disabled" name="txtLinkMan1" type="text" watermark="输入电话号码" style="width:120px;" class="text conPeople watermark">
                                    </span>
                                    <span class="formText" style="margin-left:10px;">
                                        <input id="txtLinkTel1" disabled="disabled" name="txtLinkTel1" type="text" watermark="分机号" style="width:80px;" class="text conPhone watermark">
                                    </span>
                                    <span class="tipTxt" style="margin-left:10px;display: none"><a href="javascript:void(0);" onclick="jobAdd.addNewLinkWay(this);">增加</a></span>
                                    <span class="tipPos">
                                        <span class="tipLay">
                                        </span>
                                    </span>
                                </li>
                                {//section/}
                            </ul>
                        </div>
                        <input type="hidden" name="newLinkWayCount" value="{/if empty($linkways) || sizeof($linkways) == 0/}1{/else/}{/sizeof($linkways)/}{//if/}">
                    </div>
                </div>
                <div class="formBtn" style="margin-top: 30px">
                    <a href="javascript:void(0);" class="btnsF16 btn1" id="publish">下一步</a>
                    </div>
            </div>
    	</hgroup>
    </section>
</div>
</form>

{/include file="footer.html"/}
<section class="floatRT"><a href="{/base_lib_Constant::MAIN_URL_NO_HTTP/}/about/message" target="_blank" class="serviceLink">我有问题要反馈</a><b></b></section>

<script type="text/javascript">

/*
function setWelfare(obj){
    var id = $(obj).attr('data-value');
    var data_name = $(obj).attr('data-name');
    var welfares = $('#'+data_name).val();
    if(welfares == '') welfares = new Array();
    else welfares = welfares.split(',');
    if($(obj).hasClass('cur')){
        if($.inArray(id, welfares) >= 0) welfares.splice(welfares.indexOf(id), 1);
        $(obj).removeClass('cur');
    }else{
        if(welfares.length >= 12){
            $.anchorMsg("最多只能选择12项");
            return false;
        }
        if($.inArray(id, welfares) < 0) welfares.push(id);
        $(obj).attr('class', 'cur');
    }
    welfares = welfares.join(',');
    $('#'+data_name).val(welfares);
}
 */

hbjs.use('@jobSorter, @jobDropList, @form, @jobDialog, @actions, @areaDrop', function (m) {
	
	var $ = m['cqjob.actions'].extend(m['cqjob.jobDropList'], m['cqjob.jobValidate'], m['cqjob.jobForm'], m['cqjob.jobDialog']);
	var cookie = m['tools.cookie'],
		util = m['base.util'],
		Dialog = m['widge.overlay.hbDialog'],
		jobSorter = m['product.jobSort.jobSorter'],
        AreaDrop = m['product.areaDrop'];
	
	var jobsortInput = $('#newJobsort'),
		jobsortHidInput = $('input[name=main_jobsort]'),
		jobsortInput2 = $('#nextJobsort'),
		jobsortHidInput2 = $('input[name=next_jobsort]'),
		txtStation = $('input[name=txtStation]');
	
	$("#jobType3").on('click', function(){
		if ($(this).is(":checked")) {
			$("#jobtype").val($(this).val());
		} else {
			$("#jobtype").val(1);
		}
	});
	
	$('#selectedReward').on('click', 'a', function(e){
		var target = $(e.currentTarget);
		setWelfare(target);
	});
	$('#selectedFea').on('click', 'a', function(e){
		var target = $(e.currentTarget);
		setWelfare(target);
	});



    //应届生专员 应届生专业  main_professionalSort

    var newProfessionalSort = $('#newProfessionalSort');
    var newProfessionalSortHidInput =  $('input[name=main_professionalSort]');
    var newJobsort = new jobSorter({
        trigger: newProfessionalSort,
        selectedId:  newProfessionalSortHidInput.val(),
        maxLength: 5,
        search: {
            dataSource: '{/$siteurl.main/}/profession/searchJobsort?jobSortName={{query}}&pageSize={{pageSize}}&callback=jobsortcallback',
            size: 10
        },
        model: true,
        level: false,
        url: '{/$siteurl.style|replace:"http:":""/}/js/v2/data/professionData.js?v=20150226'
    });


    function setWelfare(obj){
		var data_name = $(obj).attr('data-name');
		var length = $('a[data-name="' + data_name + '"].cur').size();
		
		if($(obj).hasClass('cur')){
			$(obj).removeClass('cur');
		}else if(length > 11){
			$.anchorMsg("最多只能选择12项");
			return false;
		}else{
			$(obj).attr('class', 'cur');
		}
		
		var welfares = new Array();
		$('a[data-name="' + data_name + '"]').each(function(i,n){
			if($(n).hasClass('cur')) welfares.push($(n).attr('data-value'));
		});
		
		$('#'+data_name).val(welfares.join(','));
	}
	
	var newJobsort = new jobSorter({
			trigger: jobsortInput,
			selectedId:  jobsortHidInput.val(),
			maxLength: 1,
			search: {
				dataSource: '//www.huibo.com/jobsort/searchJobsort?jobSortName={{query}}&pageSize={{pageSize}}&callback=jobsortcallback',
				size: 10
			},
			model: true
		}),
		nextJobsort = new jobSorter({
			trigger: jobsortInput2,
			selectedId:  jobsortHidInput2.val(),
			maxLength: 1,
			search: {
				dataSource: '//www.huibo.com/jobsort/searchJobsort?jobSortName={{query}}&pageSize={{pageSize}}&callback=jobsortcallback',
				size: 10
			},
			model: true
		});
		
	newJobsort.on('submit', function(e){
		var val = e.data.label.join(',');
		if(val){
			txtStation.val(val);
			txtStation.trigger('blur');
			$('#txtStation').focus();
		}
	});
	
	$('#addHtml').on('click', function(){
		$("#hidLastJobsort").show();
		$(this).hide();
	});
	$('#delHtml').on('click', function(){
		 jobsortHidInput2.val('');
		 nextJobsort.clearAllItem();
		 $("#hidLastJobsort").hide();
		 $("#addHtml").css({'display':'inline-block'});	
	});
	txtStation.blur(function() {
		jobAdd.getJobTemplate($(this).val());
		jobAdd.recommendJob();
	});
	
	var station            = '';
	var template           = "";
	var currenDate         = new Date();
	var isContentConfirm   = false;
	var isOtherNeedConfirm = false;
	var jobAddValid;
	var jobAdd = {
		initialize : function() {
			//初始化控件
			this._initControl();
			$('.watermark').watermark2();
		},
		addJobsort:function() {
			$("#hidLastJobsort").show();
			$("#addHtml").hide();
		},
		deleteJobsort:function(){
			 $("input[name='next_jobsort']").val('');
			 $("#next_jobsort").html('');
			 $("#hidLastJobsort").hide();
			 $("#addHtml").css({'display':'inline-block'});
		},
		_initControl : function() {
			var $tSch = $('#tSch');

			$.focusblur("#tSchText");
			$.focusblur('#addInfo');
			$.focusColor('input.text');
			$.focusColor('textarea.textarea');
			$.focusblur('input.conPeople');
			$.focusblur('input.conPhone');
			$.focusblur('input.newMail');
			$('#tSchText').bind('focus',function(){
				$(this).animate({'width':200});
				$tSch.css({'background':'#fffdef','border':'1px solid #e8dd9e'})
			}).bind('blur',function(){
				$(this).animate({'width':150});
				$tSch.css({'background':'#fff','border':'1px solid #dadada'})
			});
			$('.oppenWay').click(function(){
				$(this).toggleClass('oppenWaycut');							  
			});
			
			
			$('#x_salary_nav li').click(function(){
				$(this).parent("#x_salary_nav").children(".x_cur").removeClass("x_cur");					
				$(this).addClass('x_cur');									 
			});
			
			//初始化岗位级别下拉控件
			$('#jobLevelDrop').droplist({
				defaultTitle : '请选择',
				noSelectClass : 'gray',
				inputWidth : 125,
				style : 'width:133px;',
				hddName : 'hddJoblevel',
				items : {/$job_level_json/},
				onSelect : function(i, name) {
				}
			});
            //添加地图
            var map = new BMap.Map("mapCon");
            map.enableScrollWheelZoom();
            var pt = new BMap.Point({/$map_x/},{/$map_y/});

            var myIcon = new BMap.Icon("{/$siteurl.style/}/img/common/maplabel.png", new BMap.Size(33,50));
            marker = new BMap.Marker(pt,{icon:myIcon});  // 创建标注
            map.addOverlay(marker);              // 将标注添加到地图中
            marker.enableDragging();
            marker.setTitle('请拖动至上班位置');

            var label = new BMap.Label("请拖动至上班位置",{offset:new BMap.Size(35,5)});
            marker.setLabel(label);

            //添加事件，在拖动时去掉文字提示
            marker.addEventListener('dragstart',function(){
                label.setStyle({display:'none'});
            });
            var geoc = new BMap.Geocoder();
            marker.addEventListener('dragend',function(e){
                var poi = marker.getPosition();
                geoc.getLocation(poi, function(rs){
                    var addComp = rs.addressComponents;
                    $("#addInfo").val(addComp.province + addComp.city + addComp.district + addComp.street + addComp.streetNumber);
                    $(".txtLabel").hide();
                    $('input[name=map_x]').val(marker.getPosition().lng);
                    $('input[name=map_y]').val(marker.getPosition().lat);
                });    

            });
            map.centerAndZoom(pt,18); 

            var ac = new BMap.Autocomplete(    //建立一个自动完成的对象
                {"input" : "addInfo",
                "location" : map
            });

            ac.setInputValue("{/$company_address/}");
            ac.addEventListener("onhighlight", function(e) {  //鼠标放在下拉列表上的事件
                var str = "";
                var _value = e.fromitem.value;
                var value = "";
                if (e.fromitem.index > -1) {
                    value = _value.province +  _value.city +  _value.district +  _value.street +  _value.business;
                }    
                str = "FromItem<br />index = " + e.fromitem.index + "<br />value = " + value;

                value = "";
                if (e.toitem.index > -1) {
                    _value = e.toitem.value;
                    value = _value.province +  _value.city +  _value.district +  _value.street +  _value.business;
                }    
                str += "<br />ToItem<br />index = " + e.toitem.index + "<br />value = " + value;
                G("searchResultPanel").innerHTML = str;
            });
            var myValue;
            ac.addEventListener("onconfirm", function(e) {    //鼠标点击下拉列表后的事件
                var _value = e.item.value;
                myValue = _value.province +  _value.city +  _value.district +  _value.street +  _value.business;
                G("searchResultPanel").innerHTML ="onconfirm<br />index = " + e.item.index + "<br />myValue = " + myValue;
                setPlace();
            });

            function G(id) {
                return document.getElementById(id);
            }
            function setPlace(){
                map.clearOverlays();    //清除地图上所有覆盖物
                function myFun(){
                    var pp = local.getResults().getPoi(0).point;    //获取第一个智能搜索的结果
                    map.centerAndZoom(pp, 18);
                    marker.setPosition(pp);
                    map.addOverlay(marker);    //添加标注
                    $('input[name=map_x]').val(pp.lng);
                    $('input[name=map_y]').val(pp.lat);
                }
                var local = new BMap.LocalSearch(map, { //智能搜索
                  onSearchComplete: myFun
                });
                local.search(myValue);
            }
			//初始化工作地点控件

            var areaDrop = new AreaDrop({
                container: $('#area'),
                hidName: 'hddArea',
                selectedValue: '{/$company_area/}'
            });

            areaDrop.on('selectedItem', function(e){
                var no_child_area_ids = {/$no_child_area_ids/};
                var areaDesc = this.getLabel();

                if(myValue != areaDesc){
                    $("#addInfo").val(areaDesc);
                    myValue = areaDesc;
                    setPlace();
                }
                var pre_area_id = e.selectedValue;
                pre_area_id = pre_area_id.substring(0,2);
                if(pre_area_id == '03'){
                    $("#salaryRefer").show();

                }else{
                    $("#salaryRefer").hide();
                }

            })

            /*
			$('#area').singleArea({
				hddName:'hddArea',
				showLevel:4,
				{/if $account_type == "NotMemberTypeArea"/}
				controlClass:'zindex',
				disabled: [true, true],
				onClick: function(data) {
					if (data.level < 2) {
						$.showModal("{/get_url rule="/job/typeArea/"/}", {title : '友情提示'});
					}
				}
				{/else/}
				controlClass:'zindex',
                onSelect:function(a){
                    var no_child_area_ids = {/$no_child_area_ids/};
                    if(a.level == 2 || $.inArray(a.id,no_child_area_ids) >= 0){
                        var areaDesc = '';
                        var areas = $('#area').getAreaNames();
                        for(var i=0;i<areas.length;i++){
                            areaDesc += areas[i] ;
                        }
                        if(myValue != areaDesc){
                            $("#addInfo").val(areaDesc);
                            myValue = areaDesc;
                            setPlace();
                        }
                    }
                }
				{//if/}
			});
			$('#area').setArea('{/$company_area/}');
			*/

            //详细地址焦点离开
            $("#addInfo").blur(function(){
                if($.trim($(this).val()) != '' && myValue != $.trim($(this).val())){
                    myValue = $.trim($(this).val());
                    setPlace();
                }
            });
			//初始化薪资下拉控件1
			$('#salaryDrop1').droplist({
				defaultTitle : '{/$job.min_salary/}',
				isCanWrite : true,
				noSelectClass : 'gray',
				inputWidth : 50,
				hddName : 'hddSalary1',
				items : {/$salary_json/},
				onSelect : function(i, name) {
					$('input[name=hddSalary1]').trigger('blur');
				}
			});
	
			//初始化薪资下拉控件2
			$('#salaryDrop1End').droplist({
				defaultTitle : '{/$job.max_salary/}',
				isCanWrite : true,
				noSelectClass : 'gray',
				inputWidth : 50,
				hddName : 'hddSalary1End',
				items : {/$salary_json/},
				onSelect : function(i, name) {
					$('input[name=hddSalary1End]').trigger('blur');
				}
			});
				
			//初始化薪资下拉控件3
			$('#salaryDrop2').droplist({
				isCanWrite : true,
				noSelectClass : 'gray',
				inputWidth : 50,
				hddName : 'hddSalary2',
				items : {/$salary_json/},
				onSelect : function(i,name) {
					$('input[name=hddSalary2]').trigger('blur');
				}
			});
	
			//初始化薪资下拉控件4
			$('#salaryDrop2End').droplist({
				isCanWrite : true,
				noSelectClass : 'gray',
				inputWidth : 50,
				hddName : 'hddSalary2End',
				items : {/$salary_json/},
				onSelect : function(i,name) {
					$('input[name=hddSalary2End]').trigger('blur');
				}
			});
	
			//初始化薪资下拉控件5
			$('#salaryDrop3').droplist({
				isCanWrite : true,
				noSelectClass : 'gray',
				inputWidth : 50,
				hddName : 'hddSalary3',
				items : {/$salary_json/},
				onSelect : function(i,name) {
					$('input[name=hddSalary3]').trigger('blur');
				}
			});
	
			//初始化薪资下拉控件6
			$('#salaryDrop3End').droplist({
				isCanWrite : true,
				noSelectClass : 'gray',
				inputWidth : 50,
				hddName : 'hddSalary3End',
				items : {/$salary_json/},
				onSelect : function(i,name) {
					$('input[name=hddSalary3End]').trigger('blur');
				}
			});
			
			//初始化有效期
			jobAdd.changeEndtime($(':input[name="txtValidDays"]'));
	
			//初始化工作年限下拉控件
			$('#workYearDrop').droplist({
                defaultTitle : '请选择',
				noSelectClass : 'gray',
				inputWidth : 105,
				style : 'width:113px;',
				hddName : 'hddWorkyear',
				items : {/$workyear_json/},
				onSelect : function(i, name) {
				}
			});
			
			//初始化学历下拉控件
			$('#degreeDrop').droplist({
                defaultTitle : '请选择',
				noSelectClass : 'gray',
				inputWidth : 105,
				style : 'width:113px;',
				hddName : 'hddDegree',
				items : {/$degree_json/},
				onSelect : function(i, name) {
				}
			});
			
			//初始化性别要求下拉控件
			$('#sexDrop').droplist({
				selectValue : '0',
				noSelectClass : 'gray',
				inputWidth : 105,
				style : 'width:113px;',
				hddName : 'hddSex',
				items : {/$sex_json/},
				onSelect : function(i, name) {
				}
			});
	
			//初始化年龄要求下拉控件1
			$('#ageDrop1').droplist({
				selectValue : '0',
				noSelectClass : 'gray',
				inputWidth : 105,
				hddName : 'hddAge1',
				items : {/$age_json/},
				onSelect : function(i, name) {
				}
			});
			
			//初始化年龄要求下拉控件2
			$('#ageDrop2').droplist({
				selectValue : '0',
				noSelectClass : 'gray',
				inputWidth : 105,
				hddName : 'hddAge2',
				items : {/$age_json/},
				onSelect : function(i, name) {
				}
			});
			
			//初始化语言下拉控件
			$('#languageDrop').droplist({
				selectValue : '0',
				noSelectClass : 'gray',
				inputWidth : 105,
				style : 'width:213px;',
				hddName : 'hddLanguage',
				items : {/$language_json/},
				onSelect : function(i, name) {
				}
			});
	
			// 代招企业去掉
			$("#hddComDrop").droplist({
				selectValue : '0',
				noSelectClass : 'gray',
				inputWidth : 240,
				style : 'width:248px;',
				hddName : 'hddComId',
				items : {/$accounts_json/},
				onSelect : function(i, name) {
					if (i != '0') {
						$.ajax({
							url: '{/get_url rule="/job/gethrcominfo/"/}?company_id=' + i,
							success: function (e) {
								$('#area').setShowMenu(false);
								$('#area').setArea(e.area_id, true);
								$('#addInfo').val(e.address);
	
								$("#hidOtherReward").val(e.hidOtherReward);
								$("#hidDefaultReward").val(e.hidDefaultReward);
	
								jobAdd.refreshReward(e.hidDefaultReward, e.company_reward_names, e.hidOtherReward);
							}
						});
					}
				}
			});
			$.setIndex('zindex');
	
			$(':input[name="radJobType"]').click(function(){
				if ($(this).val() == '3'){
					$('#jobLevelDrop').setDropListValue('01');
				}else{
					$('#jobLevelDrop').setDropListValue('02');
				}
			});
			
			//验证职位类别
			$.validator.addMethod("JobsortValidate", function() {
				var jobs = $('input[name=main_jobsort]').val();
				if (jobs==undefined || jobs=='' ) {
					return false;
				} else {
					return true;
				}
			}, '请选择职位类别');
			
			//验证期望地点
			$.validator.addMethod("AreaValidate", function() {
				var jobs = $('input[name=hddArea]').val();
				if (jobs==undefined || jobs=='' ) {
					return false;
				} else {
					return true;
				}
			}, '请选择地区');
		
			$.validator.addMethod("ageAstrict", function(value, element, params) {
				var ageLower = $(params[0]).val();
				if (!ageLower) return false;
				var isNum = /^\d*$/;
				if (!(isNum.test(ageLower)) || !(isNum.test(value))) {
					return false;
				}
				else {
					if (parseInt(value) == 0 || parseInt(ageLower) == 0) {
						return true;
					}
					if (parseInt(value) >= parseInt(ageLower)) {
						return true;
					}
					return false;
				}
			}, '年龄下限不能小于年龄上限');
			
		
			// 招聘公司访问规则
			$.validator.addMethod("hddComRule", function (value, element) {
				if ($("input[name=hddComId]").is(":hidden")) {
					return true;
				}
		
				if (value == 0 || value == null || value == '')
					return false;
		
				return true;
			}, '请选择招聘公司');
			
			var inputId = /(\d)(End)?$/,
				inputName = "input[name=hddSalary{x}]";
			$.validator.addMethod('comparePrice', function(value, element){
				var matched = inputId.exec(element.name);
				var id = matched[1],
					EndName = matched[2] ? id : id + 'End',
					otherInput = $(inputName.replace('{x}', EndName)),
					otherValue = parseInt(otherInput.val()),
					value = parseInt(value),
					f;
		
				if(matched[2]){
					f = value >= otherValue && value / 2 <= otherValue;
				} else {
					f = otherValue >= value && otherValue / 2 <= value;
				}
				if(f){
					otherInput.removeClass('error');
				}
				return f;
			}, '薪资范围不大于2倍差距<span class="tipArr"></span>');
			$.validator.addMethod('comparePrice1', function(value, element){
			var matched = inputId.exec(element.name),
				id = matched[1],
				otherId = (id == 2 ? 3 : 2) + (matched[2] || ''),
				otherInput = $(inputName.replace('{x}', otherId)),
				otherValue = parseInt(otherInput.val()),
				value = parseInt(value),
				f;
			if(id == 1){return true;}
			if(id == 2){
				f = value < otherValue;
			} else {
				f = otherValue < value;
			}
			if(f){
				otherInput.removeClass('error');
			}
			return f;
		}, '平均工资不能低于底薪<span class="tipArr"></span>');

		var minSalaryRules = {
			required: true, 
			number: true, 
			range: [500, 100000],
			comparePrice: true,
			comparePrice1: true,  
			digits: true
		},
		maxSalaryRules = {
			required: true, 
			number: true, 
			range: [500, 100000],
			comparePrice: true, 
			comparePrice1: true, 
			digits: true
		},
		minSalaryMsg = {
			required: '请输入薪资待遇<span class="tipArr"></span>', 
			number: '薪资只能输入数字<span class="tipArr"></span>', 
			range: '请输入正确的薪资<span class="tipArr"></span>',
			digits: '薪资只能输入整数<span class="tipArr"></span>' 
		},
		maxSalaryMsg = {
			required: '请输入薪资待遇<span class="tipArr"></span>', 
			number: '薪资只能输入数字<span class="tipArr"></span>', 
			range: '请输入正确的薪资<span class="tipArr"></span>', 
			digits: '薪资只能输入整数<span class="tipArr"></span>' 
		};

	
		//客户端验证表单数据
		jobAddValid = $("#formjobadd").validate({
			ignore:"#txtOtherReward",
			rules: {
				txtStation: {
					required: true, rangelength:[2, 30]
				},
				hddComId : {hddComRule : true},
				hddJoblevel:{required: true},
				// hddJobDept:{required:true},
				main_jobsort:{JobsortValidate:true},
				txtQuantity: { required: true, digits: true, min: 1, max: 999 },
				hddArea:{AreaValidate:true},
				txtProbationPeriodFee: {ProbationPeriodFeeValidate: true, digits: true, min: 0},
				txtContent: { required: true, minlength:20, maxlength: 2000 },
				txtValidDays: { required: true, number: true, min: 1, max: 60, digits: true},
                hddWorkyear:{required: true},
                hddDegree:{required:true},
                txtOtherNeed: { required: false, maxlength: 2000 },
				txtLinkMan1: { required: true, tel: true },
				txtLinkTel1: { number: true },
				txtReApplyType:{required:true},
				hddSalary1: minSalaryRules,
				hddSalary1End:  maxSalaryRules,
				hddSalary2: minSalaryRules,
				hddSalary2End:  maxSalaryRules,
				hddSalary3: minSalaryRules,
				hddSalary3End:  maxSalaryRules,
				email1: { txtToMailValidate: true, email: true }
			},
			messages: {
				txtStation: { required: '请输入职位名称<span class="tipArr"></span>', rangelength: '2-30个字<span class="tipArr"></span>'},
				hddJoblevel:{ required: '请选择岗位级别<span class="tipArr"></span>'},
				// hddJobDept:{required:'请选择部门<span class="tipArr"></span>'},
				hddComId : {hddComRule : '请选择招聘公司<span class="tipArr"></span>'},
				main_jobsort: { JobsortValidate:'请选择职位类别<span class="tipArr"></span>'},
				txtQuantity: { required: '请输入招聘人数<span class="tipArr"></span>', digits: '招聘人数只能输入整数<span class="tipArr"></span>', min: '招聘人数为1～3位整数<span class="tipArr"></span>', max: '招聘人数为1～3位整数<span class="tipArr"></span>' },
				hddArea: {AreaValidate:'请选择工作地点<span class="tipArr"></span>'},
				txtProbationPeriodFee: {ProbationPeriodFeeValidate: '试用期薪资不能为空<span class="tipArr"></span>', digits: '试用期薪资只能输入整数<span class="tipArr"></span>', min: '试用期薪资不能小于0<span class="tipArr"></span>'},
				txtContent: { required: '请输入岗位职责<span class="tipArr"></span>', minlength: '太过简单了吧，最少20个字<span class="tipArr"></span>', maxlength: '不能超过2000个字<span class="tipArr"></span>' },
				txtValidDays: { required: '请输入有效期<span class="tipArr"></span>', number: '请输入1-60之间的整数<span class="tipArr"></span>', min: '请输入1-60之间的整数<span class="tipArr"></span>', max: '请输入1-60之间的整数<span class="tipArr"></span>', digits: '请输入1-60之间的整数<span class="tipArr"></span>'},
                hddWorkyear: { required: '请选择工作经验<span class="tipArr"></span>'},
                hddDegree: { required: '请选择最低学历<span class="tipArr"></span>'},
                txtOtherNeed: { required: '请输入任职资格<span class="tipArr"></span>', maxlength: '不能超过2000个字<span class="tipArr"></span>' },
				txtLinkMan1: { required: '联系人电话不能为空<span class="tipArr"></span>', tel: '联系电话不正确<span class="tipArr"></span>' },
				txtLinkTel1: {number: '分机号不正确<span class="tipArr"></span>'},
				txtLinkMan2: { txtLinkManValidate: '联系人和电话不能为空<span class="tipArr"></span>' },
				txtLinkTel2: {txtLinkTelValidate: '联系人和电话不能为空<span class="tipArr"></span>',tel:'联系电话不正确<span class="tipArr"></span>'},
				txtLinkMan3: { txtLinkManValidate: '联系人和电话不能为空<span class="tipArr"></span>' },
				txtLinkTel3: {txtLinkTelValidate: '联系人和电话不能为空<span class="tipArr"></span>',tel:'联系电话不正确<span class="tipArr"></span>'},
				email1: { txtToMailValidate: '请输入邮箱<span class="tipArr"></span>', email: '邮箱格式不正确<span class="tipArr"></span>' },
				email2: { txtToMailValidate: '请输入邮箱<span class="tipArr"></span>', email: '邮箱格式不正确<span class="tipArr"></span>' },
				email3: { txtToMailValidate: '请输入邮箱<span class="tipArr"></span>', email: '邮箱格式不正确<span class="tipArr"></span>' },
				txtReApplyType:{required:'请选择简历回复承诺类型<span class="tipArr"></span>'},
				hddSalary1: minSalaryMsg,
				hddSalary1End: maxSalaryMsg,
				hddSalary2: minSalaryMsg,
				hddSalary2End:  maxSalaryMsg,
				hddSalary3: minSalaryMsg,
				hddSalary3End:  maxSalaryMsg
			},
			tips: {
			},
			errorElement: 'span',
			errorClasses: {
				txtStation: { required: 'tipLayErr tipw180', rangelength: 'tipLayErr tipw180'},
				hddComId : {hddComRule: 'tipLayErr tipw180'},
				hddJoblevel: { required: 'tipLayErr tipw180'},
				// hddJobDept: {required:'tipLayErr tipw180'},
				txtReApplyType:{required:'tipLayErr tipw180'},
				main_jobsort: { JobsortValidate:'tipLayErr tipw180'},
				txtQuantity: { required: 'tipLayErr tipw180', digits:'tipLayErr tipw180', min:'tipLayErr tipw180', max:'tipLayErr tipw180'},
				hddArea: {AreaValidate:'tipLayErr tipw180'},
				hddSalary1: {required: 'tipLayErr tipw180', number: 'tipLayErr tipw180', range: 'tipLayErr tipw180', digits: 'tipLayErr tipw180', comparePrice: 'tipLayErr tipw180',comparePrice1: 'tipLayErr tipw180'},
				hddSalary1End: {required: 'tipLayErr tipw180', number: 'tipLayErr tipw180', range: 'tipLayErr tipw180', digits: 'tipLayErr tipw180',comparePrice: 'tipLayErr tipw180',comparePrice1: 'tipLayErr tipw180'},
				hddSalary2: {required: 'tipLayErr tipw180', number: 'tipLayErr tipw180', range: 'tipLayErr tipw180', digits: 'tipLayErr tipw180', comparePrice: 'tipLayErr tipw180',comparePrice1: 'tipLayErr tipw180'},
				hddSalary2End: {required: 'tipLayErr tipw180', number: 'tipLayErr tipw180', range: 'tipLayErr tipw180', digits: 'tipLayErr tipw180',comparePrice: 'tipLayErr tipw180',comparePrice1: 'tipLayErr tipw180'},
				hddSalary3: {required: 'tipLayErr tipw180', number: 'tipLayErr tipw180',range: 'tipLayErr tipw180', digits: 'tipLayErr tipw180',comparePrice: 'tipLayErr tipw180',comparePrice1: 'tipLayErr tipw180'},
				hddSalary3End: {required: 'tipLayErr tipw180', number: 'tipLayErr tipw180', range: 'tipLayErr tipw180', digits: 'tipLayErr tipw180',comparePrice: 'tipLayErr tipw180',comparePrice1: 'tipLayErr tipw180'},
				txtProbationPeriodFee: {ProbationPeriodFeeValidate:'tipLayErr tipw180', digits: 'tipLayErr tipw180', min: 'tipLayErr tipw180'},
				txtContent: { required: 'tipLayErr tipw180', minlength: 'tipLayErr tipw180', maxlength: 'tipLayErr tipw180' },
				txtValidDays: { required: 'tipLayErr tipw180', number: 'tipLayErr tipw180', min: 'tipLayErr tipw180', max: 'tipLayErr tipw180', digits: 'tipLayErr tipw180'},
                hddWorkyear: { required: 'tipLayErr tipw180'},
                hddDegree: { required: 'tipLayErr tipw180'},
                txtOtherNeed: { required: 'tipLayErr tipw180', minlength: 'tipLayErr tipw180', maxlength: 'tipLayErr tipw180' },
				txtLinkMan1: {required: 'tipLayErr tipw180', tel: 'tipLayErr tipw180'},
				txtLinkTel1: { number:'tipLayErr tipw180' },
				txtLinkMan2: { txtLinkManValidate: 'tipLayErr tipw180' },
				txtLinkTel2: { txtLinkTelValidate: 'tipLayErr tipw180', tel:'tipLayErr tipw180' },
				txtLinkMan3: { txtLinkManValidate: 'tipLayErr tipw180' },
				txtLinkTel3: { txtLinkTelValidate: 'tipLayErr tipw180', tel:'tipLayErr tipw180' },
				email1: { txtToMailValidate: 'tipLayErr tipw180', email: 'tipLayErr tipw180' },
				email2: { txtToMailValidate: 'tipLayErr tipw180', email: 'tipLayErr tipw180' },
				email3: { txtToMailValidate: 'tipLayErr tipw180', email: 'tipLayErr tipw180' }
			},
			tipClasses:{
				txtStation: 'tipLayTxt tipw150'
			},
			groups:{
				salary1: 'hddSalary1 hddSalary1End',
				salary2: 'hddSalary2 hddSalary2End',
				salary3: 'hddSalary3 hddSalary3End',
				linkway1: 'txtLinkMan1 txtLinkTel1',
				linkway2: 'txtLinkMan2 txtLinkTel2',
				linkway3: 'txtLinkMan3 txtLinkTel3'
			},
			errorPlacement: function(error, element) {
				if(element.attr('name') == 'txtValidDays' || element.attr('name') == 'hddjobsort' || element.attr('name') == 'hddArea'){
					element.closest('div.r').find('.tipLay').append(error);
				} else if(element.attr('name') == 'hddSalary1' || element.attr('name') == 'hddSalary1End' || element.attr('name') == 'hddSalary2' || element.attr('name') == 'hddSalary2End'){
					element.closest('.x_salaryBg').find('.tipLay').eq(0).append(error);
				} else if(element.attr('name') == 'hddSalary3' || element.attr('name') == 'hddSalary3End'){
					element.closest('.x_salaryBg').find('.tipLay').eq(1).append(error);
				} else {
					element.parent().nextAll().find('.tipLay').append(error);
				}
			},
			success: function(label) {
				$("#salaryDrop2End").next(".tipPos").find(".tipLayErr").html("").attr("class","error");
				$("#salaryDrop3End").next(".tipPos").find(".tipLayErr").html("").attr("class","error");
				label.text(" ");
			}
		});
	  
		var salaryRadio = $('#x_salary_nav input[type=radio]'),
			x_salaryBg = $('#x_salaryBg .x_salaryBg');
		
		salaryRadio.each(function(index, val){
			if($(this).prop('checked')){
				if(x_salaryBg.eq(index).is(':hidden')){
					tabSalary(index);
				}
				disableSalary(index);
			}
		});
		salaryRadio.on('change', function(e){
			var index = salaryRadio.index($(e.target));
			tabSalary(index);
			disableSalary(index);
		});
		
		function tabSalary(index){
			x_salaryBg.hide();
			x_salaryBg.eq(index).show();
		}
		function disableSalary(index){
			var hddSalary1 = $('input[name=hddSalary1]'),
				hddSalary1End = $('input[name=hddSalary1End]'),
				hddSalary2 = $('input[name=hddSalary2]'),
				hddSalary2End = $('input[name=hddSalary2End]'),
				hddSalary3 = $('input[name=hddSalary3]'),
				hddSalary3End = $('input[name=hddSalary3End]');
			var f1, f2;
			if(index === 0){
				f1 = false;
				f2 = true;
			} else if(index === 1){
				f1 = true;
				f2 = false;
			} else {
				f1 = f2 = true;
			}
			hddSalary1.prop('disabled', f1);
			hddSalary1End.prop('disabled', f1);
			hddSalary2.prop('disabled', f2);
			hddSalary2End.prop('disabled', f2);
			hddSalary3.prop('disabled', f2);
			hddSalary3End.prop('disabled', f2);
		}
		
		$('#btnMore').click(function(){
			if($('#divMore').is(':hidden'))
			{
				$('#divMore').show();
				$(this).removeClass('slideNone').addClass('slideShow').html('点击隐藏更多填写项');
			}
			else
			{
				$('#divMore').hide();
				$(this).removeClass('slideShow').addClass('slideNone').html('点击展开更多填写项');
			}
		});
		$('#txtReplyContent').setListen({ max: 4000, objLeft: $('#spnReplyContent') });
		$('#txtContent').keydown(function() {
			isContentConfirm = true;
		});
		$('#txtOtherNeed').keydown(function() {
			isOtherNeedConfirm = true;
		});
		$('#btnApplySalary').click(function() {
			$('#selSalaryLower').val($('#avg_min_salary').html());
			$('#selSalaryUpper').val($('#avg_max_salary').html());
			return false;
		});

	  
		$("#txtOtherReward").focus(function() {
			if ($(this).val() == ""||$(this).val()==$(this).attr('watermark')) {
				rewardPoint += 0.1;
				jobAdd.rewardPointShow();
			}
		}).blur(function() {
			if ($(this).val() == ""||$(this).val()==$(this).attr('watermark')) {
				rewardPoint -= 0.1;
				jobAdd.rewardPointShow();
			}
		});
		
		$('#txtReplyContent').focus(function(){
			$('#chkAutoReply').attr('checked',true);
		}).blur(function(){
			if($(this).val()=='')
			{
				$('#chkAutoReply').attr('checked',false);
			}
		});
		
		$('#contentTrim').click(function() {
			$('#txtContent').val('');
		});
		
		$('#otherNeedTrim').click(function() {
			$('#txtOtherNeed').val('');
		});
		
		$('#replyContentTrim').click(function() {
			$('#txtReplyContent').val('');
			$('#chkAutoReply').attr('checked',false);
		});
		
		$('#chkIsUpdate').click(function(){
			if($(this).attr('checked'))
			{
				$('#txtLinkTel').removeAttr('disabled');
				$('#txtEmail').removeAttr('disabled');
			}
			else
			{
				$('#txtLinkTel').attr('disabled','disabled');
				$('#txtEmail').attr('disabled','disabled');
			}
		});
		
		//预览职位
		$('#btnPreview').click(function() {
			if (!checkCompanyLogin()) return;
			jobAdd.preview();
		});
		
		$('#txtEndTime').blur(function(){
			if($(this).val()!='')
			{
				$('#txtRefreshEndTime').val($(this).val());
			}
		});	
		$('#txtValidDays').keyup(function(){
			jobAdd.changeEndtime(this);
		});
		
		$('#recommendContent, #recommendOtherNeed').on('click', 'a', function(e){
			var target = e.currentTarget;
			jobAdd.getTemplateContentOrOtherNeed(target);
		});
	
		$('#publish').on('click', function(e){
			jobAdd.addNetJob(this, false);
		});
		
		$("#recommendJob").on('click', 'input[name="chkJobsort"]', function(e){
			target = e.currentTarget;
			jobAdd.selectJobName(target);
		});
		
	},
	changePeriodSymbol:function(obj){
		var theValue = $.trim($(obj).val());
		if(!isNaN(theValue)){
			if(theValue > 100){
				$('#periodPercent').html('元/月');
			}
			else{
				$('#periodPercent').html('%');
			}
		}
		else{
			$('#periodPercent').html('');
		}
	},
	changeEndtime:function(obj){
		var theValue = $.trim($(obj).val());
		if(!isNaN(theValue)){
			if(theValue >= 1 && theValue <= 90){
				//有效期至2013年8月19日
				end = new Date();
				end = new Date(end.valueOf() + theValue*24*60*60*1000);
				//$('#endTimeSpan').html('有效期至' + end.toLocaleDateString());
				$('#endTimeSpan').html('有效期至' + end.getFullYear() + '年' + (end.getMonth() + 1) + '月' + end.getDate() + '日');
			}
			else{
				$('#endTimeSpan').html('');
			}
		}
		else{
			$('#endTimeSpan').html('');
		}
	},
	getJobTemplate:function(value) {
		//获取职位内容模板和推荐职位信息
		if (station == value) {
			return;
		} else {
			value = encodeURIComponent(value);
			$.getJSON('{/get_url rule="/job/jobLoadTemplates/" data="jobname='+value+'"/}', function(data) {
				if (data.content.length <= 0) {
					$('#recommendContent').hide();
					$('#recommendOtherNeed').hide();
					return;
				}
				$('#recommendContent').show();
				$('#recommendOtherNeed').show();
				jobAdd.getTheTemplate(data.content);
				//$('#jobContentTemplate').templatepaging(data.content, '#txtContent', '#txtOtherNeed');
			});
		}
	},
    getJobTemplate : function(value) {
        //获取职位内容模板和推荐职位信息
        if (station == value) {
            return;
        } else {
            value = encodeURIComponent(value);
            var jobsort_salary_id = $('input[name=main_jobsort]').val();
            var addressId = $('input[name=hddArea]').val();

            $.getJSON('{/get_url rule="/job/jobLoadTemplates/?jobsortid='+jobsort_salary_id+'&jobname='+value+'"/}', function(data) {
                //增加薪酬查询
                if (data.content.length <= 0) {
                    $('#recommendContent').hide();
                    $('#recommendOtherNeed').hide();
                    return;
                }

                $('#recommendContent').show();
                $('#recommendOtherNeed').show();

                //if(data.salarydata.length > 0) {
                var html = '<strong style="color: #666">汇博薪酬助手</strong><br />【' + data.salarydata.jobsort_name + '】在<span style="color:#4e74d9"> 重庆 </span>的平均薪酬水平：<br />企业提供平均薪资范围<span style="color:#4e74d9">' + data.salarydata.job_min_salary + '~' + data.salarydata.job_max_salary + '元</span>（数据来自<strong>' + data.salarydata.job_num + '</strong>个职位）<br />求职者期望平均薪资<span style="color:#4e74d9">' + data.salarydata.person_salary + '元及以上</span>（数据来自<strong>' + data.salarydata.resume_num + '</strong>份简历）<p style="color: #ccc;font-size: 12px;padding-top: 5px">*汇博薪酬助手数据来源于汇博人才网用户提供的薪酬数据，仅供参考</p>';
                document.getElementById("salaryRefer").innerHTML = html;
                //}
                jobAdd.getTheTemplate(data.content);
            });
        }
    },
	getTheTemplate : function(data) {
		var contentHtml   = '模板：';
		var otherNeedHtml = '模板：';
	
		$.each(data, function (i, n) {
			contentHtml += '<a href="javascript:void(0);" theField="content" theVal="' + n.template_id + '" style="margin:0 10px 0 0;font-size:12px;">'  + n.template_name + '</a>';
	
			otherNeedHtml += '<a href="javascript:void(0);" theField="other_need" theVal="' + n.template_id + '" style="margin:0 10px 0 0;font-size:12px;">' + n.template_name + '</a>';
		});
	
		$('#recommendContent').html(contentHtml);
		$('#recommendOtherNeed').html(otherNeedHtml);
	},
	getTemplateContentOrOtherNeed:function(obj){		
		var theConfirmType = $(obj).attr('theField');
		if(theConfirmType == 'content' ? isContentConfirm : isOtherNeedConfirm) {
			$.confirm('该操作会覆盖' + (theConfirmType == 'content' ? '岗位职责' : '任职资格' ) + '原有的信息数据，您确定继续吗？', '', function() {
				theConfirmType == 'content' ? isContentConfirm = false : isOtherNeedConfirm = false;
				$.getJSON('{/get_url rule="/job/getTemplateContentOrOtherNeed/" data="templateid='+$(obj).attr('theVal')+'&field='+$(obj).attr('theField')+'"/}', function(data) {
					if (data && data.content) {
						$(obj).closest('div.r').find('textarea').val($.filterHTML(data.content)).focus();
					}
				});
			}, function() {
				theConfirmType == 'content' ? isContentConfirm = true : isOtherNeedConfirm = true;
			});
		}else{
	
			$.getJSON('{/get_url rule="/job/getTemplateContentOrOtherNeed/" data="templateid='+$(obj).attr('theVal')+'&field='+$(obj).attr('theField')+'"/}', function(data) {
				if (data && data.content) {
					$(obj).closest('div.r').find('textarea').val($.filterHTML(data.content)).focus();
				}
			});
		}
	},
	recommendJob:function() {
			$('#recommendJob').empty();
			var station = $('#txtStation').val().trim();
			if(station==''){
				return;
			}
			station = encodeURIComponent(station);
			$.getJSON('{/get_url rule="/job/getRecommendJobsort/" data="station='+station+'"/}', function(json) {
				if (!json.success) {
					$("#recommendJob").hide();
					return;
				}
				var input = '';
				for (var i = 0; i < json.jobsorts.length; i++) {
					var jobsort = json.jobsorts[i];
					input += '<input type="checkbox" id="jobsort' + jobsort.jobsortID + '" name="chkJobsort" class="chb" value="' + jobsort.jobsortID + '" /><label for="jobsort' + jobsort.jobsortID + '">'+jobsort.jobsortName+'</label>&nbsp;';
				}
				if($.trim(input) != ''){
					$("#recommendJob").show().append('<b>猜您在找：</b>' + input);   
				}
			});
	},
	selectJobName:function (obj) {
			var value = $(obj).val();
			var jobsorts_arr = $('#jobsort').getJobSortValue();
			var jobsorts = new Array();
			for(var j=0;j<jobsorts_arr.length;j++)
			{
				jobsorts.push(jobsorts_arr[j].split(',')[0]);
			}
			if ($(obj).attr("checked") == 'checked') 
			{
				if(jobsorts.length>=2)
				{
					$(obj).removeAttr("checked");
					$.anchorMsg("职位类别最多可以选择2项", { icon: 'warning' });
					return;
				}
				var flag=false;
				for(var i=0;i<jobsorts.length;i++)
				{
					if(value==jobsorts[i])
					{
						flag=true;
						break;
					}
				}
				if(!flag)
				{
					jobsorts.push(value);
					$('#jobsort').setJobSortValue(jobsorts.join(","));
				}
			}
			else 
			{
				for(var i=0;i<jobsorts_arr.length;i++)
				{
					var tempitem = jobsorts_arr[i].split(',');
					if(value == tempitem[0])
					{
						$('#jobsort').removeJobSortValue(tempitem[0], tempitem[1]);
						break;
					}
				}
			}
	},
	addNetJob:function(object, goonPublish) {
		var automatic = $(".oppenWay").hasClass("oppenWaycut") ? 1 : 0;
		var data = {operate:"publish", templateID:template, goonPublish:goonPublish, hddAutomatic:automatic};
		$(object).submitForm({ beforeSubmit: $.proxy(jobAddValid.form, jobAddValid), data: data, success: jobAdd.successCallBack, clearForm: false})
		return false;
	},
	successCallBack : function(json) {
		// 提交form后，回调函数
		var ismustreply = $(".txtReApplyType:checked").val();
		if (json && json.status) {
			/*if (json.status == "succeed") {
				//成功
				if (json.goPublish) {
					$.anchorMsg("发布职位成功", {
						onclose: function() {
							window.location.href = '{/get_url rule="/job/add"/}';
						}
					});
					return false;
				} else if (json.goPublish == false) {
					{/if $step/}
					window.location.href = '{/get_url rule="/job/spread"/}?job_id=' + json.job_id + '&type=add&step=3"/}';
					{/else/}
					window.location.href = '{/get_url rule="/job/spread"/}?job_id=' + json.job_id + '&type=add';
					{//if/}
					// window.location.href = '{/get_url rule="/job/spread"/}?job_id=' + json.job_id + '&type=add';
					return false;
				} else {
					{/if $step/}
					$.confirm('职位发布成功,是否继续发布下一个职位', '操作提示', function() {
						window.location.href = '{/get_url rule="/job/add"/}?step=3';
					}, function() {
						window.location.href = '{/get_url rule="/job/addSuccess"/}?ismustreply='+ismustreply+'&step=3';
					});
					{/else/}
					$.confirm('职位发布成功,是否继续发布下一个职位', '操作提示', function() {
						window.location.href = '{/get_url rule="/job/add"/}';
					}, function() {
						window.location.href = '{/get_url rule="/job/addSuccess"/}?ismustreply='+ismustreply;
					});
					{//if/}
				}
	
				return false;
			}*/ 
			if (json.status == "succeed") {
				if (json.goPublish) {
					$.confirm('发布职位成功，是否继续发布职位？','',function(){
						window.location.href = '{/get_url rule="/register/add"/}';
					},function(){
						window.location.href = '{/get_url rule="/licencevalidate/"/}?step=4';
					}); 
					return false;
				} else if (json.goPublish == false) {
					$.anchorMsg("发布职位成功", {
						onclose: function() {
							window.location.href = '{/get_url rule="/licencevalidate/"/}?step=4';
						}
					});
				}
			}
			else if (json.status == "fail") {
				//失败
				$.message("发布职位失败", { title: "操作提示", icon: "fail" });
			}else if (json.status == "info") {
				$.message(json.message, { title: "操作提示", icon: "fail" });
			}
		}
		else {
			//添加数据出现异常
			$.message(json.error, { title: "系统提示", icon: "fail" });
		}
	},
	onChangeLinkMan:function(v)
	{
		if (v != '' && v!=null&&v!=undefined)
		{
			var parms = { 'operate': 'GetLinkMan', 'linkID': v }
			$.getJSON('JobAdd.aspx', parms, function(json)
			{
				if(json.success)
				{
					$('#txtLinkTel').val(json.tel);
					$('#txtEmail').val(json.email);
					
					if($('#chkIsUpdate').attr('checked'))
					{
						$('#txtLinkTel').removeAttr('disabled');
						$('#txtEmail').removeAttr('disabled');
					}
				}
			});
		}
		return false;
	},
	onChangeRefreshCrcle:function(v)
	{
		if(v!=''&&v!=null&&v!=undefined&&v!='00')
		{
			$('#chkRefreshEndTime').attr('checked',true);
			$('#divRefreshEndTime').show();
		}
		else
		{
			$('#chkRefreshEndTime').attr('checked',false);
			$('#divRefreshEndTime').hide();
		}
		return false;
	},
	loadJob:function(jobID)
	{
		if(jobID!=''&&jobID!=null&&jobID!=undefined)
		{  
			var parms = { 'operate': 'GetJob', 'jobID': jobID }
			$.getJSON('JobAdd.aspx', parms, function(json)
			{
				if(json.success)
				{
					$('#txtStation').val(json.station);
					$('#btnJobsort').jobsortValues(json.jobsort);
					$('#txtContent').val(json.content);
					$('#txtOtherNeed').val(json.otherneed);
					$('#txtQuantity').val(json.quantity);
					$('#btnArea').areaValues(json.area);
					$('#txtEndTime').val(json.endtime);
					if(json.workyear!=''&&json.workyear!='-1')
					{
						$('#selWorkYear').parent('span.verSelect').find('li>a[thevalue='+json.workyear+']').parent('li').click();
					}
					if(json.degree!=''&&json.degree!='00')
					{
						$('#selDegree').parent('span.verSelect').find('li>a[thevalue='+json.degree+']').parent('li').click();
					}
					$(':input[name=radJobType][value=' + json.jobtype + ']').attr('checked', true);
					$(':input[name=radSex][value=' + json.sex + ']').attr('checked', true);
					$('#txtAgeLower').val(json.minage);
					$('#txtAgeUpper').val(json.maxage);
					if(json.language!=''&&json.language!='00')
					{
						$('#selLanguage').parent('span.verSelect').find('li>a[thevalue='+json.language+']').parent('li').click();
					}
					$('#selSalaryLower').val(json.salarylower);
					$('#selSalaryUpper').val(json.salaryupper);
					if(json.issalaryshow==true)
					{
						$('#chkIsSalaryShow').attr('checked',true);
					}
					for(var i=0;i<json.rewardIDs.length;i++)
					{
						$(':input[name=rewardID][value=' + json.rewardIDs[i] + ']').attr('checked', true);
					}
					$('#txtOtherReward').val(json.otherreward);
					if(json.linkid!=''&&json.linkid!='0')
					{
						$('#selLinkMan').parent('span.verSelect').find('li>a[thevalue='+json.linkid+']').parent('li').click();
					}
					$('#txtOtherEmail').val(json.otheremail);
					if(json.isautoreply==true)
					{
						$('#chkAutoReply').attr('checked',true);
					}
					$('#txtReplyContent').val(json.replycontent);
					
					$('#rewardPoint').html(json.rewardpoint);
					$('#hidRewardPoint').val(json.rewardpoint);
					rewardPoint=json.rewardpoint;
				}
			});
		}
		return false;
	},
	preview : function() {
		if (!checkCompanyLogin()) 
			return;
	
		var jobName     = "";
		var endTime     = "";
		var quanTity    = "";
		var workArea    = "";
		var jobType     = "";
		var jobSort     = "";
		var sex         = "";
		var age         = "";
		var degree      = "";
		var workyear    = "";
		var language    = "";
		var Salary      = "";
		var content     = "";
		var otherReward = " ";
		var otherNeed   = "";
		var rewardName  = "";
		var rewardPoint = "";
		var linkID      = 0;
	
		jobName = $.filterHTML($('#txtStation').val());
		endTime = $.filterHTML($('#txtEndTime').val());
		quanTity = $.filterHTML($('#txtQuantity').val());
		workArea = $('#btnArea').attr('title');
		jobType = $('input[name="radJobType"]:checked').next('label').html();
		jobSort = $('#btnJobsort').attr('title');
		
		sex = $('input[name="radSex"]:checked').next('label').html();
		var ageLower = $.filterHTML($('#txtAgeLower').val());
		var ageUpper = $.filterHTML($("#txtAgeUpper").val());
		if (ageLower == null || ageLower == "0" || ageLower == "") {
			if (ageUpper == null || ageUpper == "0" || ageUpper == "") {
				age = "不限";
			}
			else {
				age = ageUpper + "以下";
			}
		}
		else {
			if (ageUpper == null || ageUpper == "0" || ageUpper == "") {
				age = "以上";
			}
			else {
				age = ageLower + "~" + ageUpper;
			}
		}
		degree = $('#selDegree').parent('span.verSelect').find('li>a[thevalue='+$('#selDegree').val()+']').html();
		workyear = $('#selWorkYear').parent('span.verSelect').find('li>a[thevalue='+$('#selWorkYear').val()+']').html();
		language = $('#selLanguage').parent('span.verSelect').find('li>a[thevalue='+$('#selLanguage').val()+']').html();
		otherReward = $('#txtOtherReward').val();
		rewardPoint = $('#hidRewardPoint').val();
		$('#rewardContent').find('input:checked').each(function() {
			rewardName += $(this).next('label').html() + ',';
		})
		if(rewardName.length>0)
		{
			rewardName=rewardName.substring(0,rewardName.length-1);
		}
		if (otherReward != "" && otherReward != null && typeof otherReward != "undefined") {
			otherReward = $.filterHTML(otherReward);
		}
		if(otherReward==$('#txtOtherReward').attr('watermark'))
		{
			otherReward='';
		}
		var salaryLower = $('input[name="selSalaryLower"]').val();
		var salaryUpper = $('input[name="selSalaryUpper"]').val();
		if (salaryLower == null || salaryLower == "0" || salaryLower == "") {
			if (salaryUpper == null || salaryUpper == "0" || salaryUpper == "") {
				Salary = "不限";
			}
			else {
				Salary = salaryUpper + "元/月以下";
			}
		}
		else {
			if (salaryUpper == null || salaryUpper == "0" || salaryUpper == "") {
				Salary = salaryLower + "元/月以上";
			}
			else {
				Salary = $.filterHTML(salaryLower + "~" + salaryUpper + "元/月");
			}
		}
		if ($('#negotiable').is(':checked')) {
			Salary = "面议";
		}
		
		var params = { jobName: jobName, endTime: endTime, quantity: quanTity, workArea: workArea, jobType: jobType, jobSort: jobSort, sex: sex, age: age, degree: degree, workYear: workyear, language: language, salary: Salary, otherReward: otherReward, rewardName: rewardName, rewardPoint: rewardPoint};
		var str = $.param(params);
		$.showModal('JobPreview.aspx?' + str, { title: '职位预览' });
	},
	selectWorkYear:function(workyear)
	{
		if(workyear=='100')
		{
			$('.workYear').show();
		}
		else
		{
			$('.workYear').hide();
		}
	}
};
	jobAdd.initialize();
	
});  
</script>



<script>

    hbjs.use('@jobsort, @calling, @hbCommon, @jobDialog, @confirmBox', function(m){
        var $ = m['jquery'].extend(m['cqjob.jobsort'], m['cqjob.calling']);
        var Dialog = m['widge.overlay.hbDialog'];
        $('#yjs').click(function(){
            if($('#yjs').is(":checked")){
                //勾选了改选项
                $('#yjs_calling').show();
            }else{
                $('#yjs_calling').hide();
            }
        });

        var showLinkWayRadio = $(':input[name="showLinkway"]');
        var newLinkWayRadio = $(':input[name="newLinkway"]');
        showLinkWayRadio.click(function(){
            var checked = newLinkWayRadio.filter(':checked').val();
            if($(this).val() == '0'){
                $('div.newContact').find(':input').attr('disabled', 'disabled');
                $('div.contactWayLst').hide();
            }
            else if($(this).val() == '1'){
                $('div.newContact').find(':input').attr('disabled', checked == 1 ? false : 'disabled');
                $('div.contactWayLst').show();
                //判断当前选择是否有填写手机号，没有则给个提示
                var x = $(':input[name=newLinkway]').filter(':checked').val(); // 5 u_tel
                if(x == 5){
                    //办公电话
                    if(!$('#u_tel').text()){
                        $.message("该职位招聘人没有填写办公电话哟", {title: "操作提示", icon: "fail"});
                        $('#way1').click(); //默认值给到4
                    }
                }else if(x == 4){
                    if(!$('#u_moblie').text()){
                        $.message("该职位招聘人没有填写办公电话哟", {title: "操作提示", icon: "fail"});
                        $('#way3').click(); //默认值给到4
                    }
                }
            }
        });
        newLinkWayRadio.click(function(){
            if($(this).val() == '1'){
                $('div.newContact').show();
                $('div.newContact').find(':input').attr('disabled',false);
            } else {
                if($(this).val() == '4'){
                    if(!$('#u_moblie').html()){
                        $.message("该职位招聘人没有填写手机号哟", {title: "操作提示", icon: "fail"});
                    }
                }else if($(this).val() == '5'){
                    if(!$('#u_tel').html()){
                        $.message("该职位招聘人没有填写办公电话哟", {title: "操作提示", icon: "fail"});
                    }
                }
                $('div.newContact').hide();
                $('div.newContact').find(':input').attr('disabled','disabled');
			}
        });


        //取消在线沟通弹窗提示
        var registerDialog;
        function showRegisterDialog(registerContent){
            if(!registerDialog){
                registerDialog = new Dialog({
                    idName: 'new-sign-pop-dialog',
                    width: 300,
                    close: 'x',
                    title:'提示'

                });
                //不需要！
            }
            registerDialog.query('#companyVerCommit').off('click');
            registerDialog.setContent(registerContent);
            registerDialog.query('#companyVerCommit').on('click', function(){
                registerDialog.hide();
            });
            registerDialog.show();
        }
        function getalertHtml()
        {
            var tmp_str  = [
                '<div class="new-sign-pop-company-ver" style="text-align:center">',
                '<ul class="new-sign-popx">',
                '<li style="padding-bottom:10px">',
                '<span class="dtit" style="">您取消了在线沟通，求职者不能即时与您交流。会影响您的招聘效果</span>',
                '</li>',
                '<li style="padding-bottom:10px">',
                '<a id="companyVerCommit" data-id="'+ 1 +'" href="javascript:;" class="present" style="margin-right:0">确 定</a>',
                '</li>',
                '</ul>',
                '</div>'
            ].join('');
            return tmp_str;
        }


        $('#pa_allow_link').click(function(){
            if($('#pa_allow_link').is(":checked")){}else{
                showRegisterDialog(getalertHtml());
            }
        });

        $(function(){
            var x = $(':input[name=newLinkway]').filter(':checked').val();
            if(x == 1){
                $('#way2').click();
            }
        });
        $('select[name=param_account_id]').change(function(){
//            $('#u_moblie').html($('#account_info_'+$(this).val()).attr('data-mobile'));
//            $('#u_tel').html($('#account_info_'+$(this).val()).attr('data-link'));
            var mobile = $('#account_info_'+$(this).val()).attr('data-mobile');
            var link = $('#account_info_'+$(this).val()).attr('data-link');

            if(mobile){
                $('#u_moblie').html(mobile);
                $('#way1').parent().show();
            }else{
                $('#way1').parent().hide();
            }
            if(link){
                $('#u_tel').html(link);
                $('#way3').parent().show();
            }else{
                $('#way3').parent().hide();
            }

            if(mobile){
                $('#way1').click();
            }else if(link){
                $('#way3').click();
            }else{
                $('#way2').click();
            }

        });
    });
</script>

</body>
</html>