<!doctype html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="Keywords" content="" />
<meta name="Description" content="" />
<title>{/$title/}</title>
<!–[if lt IE9]> 
<script src="{/version file='html5.js'/}"></script>
<![endif]–>
<link rel="stylesheet" type="text/css" href="{/version file="base.css"/}" />
<link rel="stylesheet" type="text/css" href="{/version file="comback.css"/}" />
<script type="text/javascript" language="javascript" src="{/version file="jquery-1.8.3.min.js"/}"></script>
<script type="text/javascript" language="javascript" src="{/version file="common.js"/}"></script>
<script type="text/javascript" language="javascript" src="{/version file="dialog.js"/}"></script>
<script type="text/javascript" language="javascript" src="{/version file="ui_inputFocus.js"/}"></script>
<script type="text/javascript" language="javascript" src="{/version file="ui_tooltip.js"/}"></script>
<script type="text/javascript" language="javascript" src="{/version file="ui_validate.js"/}"></script>
<script type="text/javascript" language="javascript" src="{/version file="jquery.form.js"/}"></script>
<script type="text/javascript" language="javascript" src="{/version file="ui_dropdownlist.js"/}"></script>
<script type="text/javascript" language="javascript" src="{/version file="ui_autocomplete.js"/}"></script>
<script type="text/javascript" language="javascript" src="{/version file="jquery.email.tip.js"/}"></script>
<script type="text/javascript" language="javascript" src="{/version file="jquery.metadata.js"/}"></script>

</head>
<body id="body">
<style type="text/css">
hgroup{padding:0;}
.part{padding:10px 20px;zoom:1;}
.part2{padding:0 20px 20px 20px;zoom:1;}
.part .tipTxt{font-size:16px; height:40px; line-height:40px;}
.part .tipTxt em{color:#ff9900; margin:0 5px;}
.part .tipTxt i.hbFntWes{font-size:14px; margin-right:5px;}

.recHd{background:#f9f9f9; border:1px solid #e6e6e6; padding:17px 15px 0 15px; zoom:1; height:45px; font-size:12px;}

.recHd .recHdL {float: left; display: inline; line-height: 26px;}

.recHd .tipTxt{float:left; display:inline; line-height:26px; color:#999; font-size:12px;}
.recHd .recHdM{float:left; display:inline; width:310px;}
.recHd .recHdM .conBox{float:left; display:inline;}
.recHd .recHdM .conBox .from{float:left; display:inline; margin-right:10px;}
.recHd .recHdM .conBox .tipTxt i.hbFntWes{font-size:14px; margin-left:5px; position:absolute; right:10px; top:5px; cursor:pointer;}

.recHd .recHdR{float:left; display:inline; width:275px;}
.recHd .recHdR .formMod .l{width:50px; font-size:12px; margin-right:2px; color:#999;}
.recHd .recHdR .formMod .r{width:215px;}
.recHd .recHdR .checkMod .drop{width:378px;}

.recBd .lstBox{padding:20px 0 0 0; zoom:1;}
.recBd .lst .table{}
.recBd .lst .table tr th{border-bottom:1px solid #dadada;font-weight:normal; color:#999; padding:8px 5px; zoom:1;}
.recBd .lst .formChb input.chb{margin:2px 0 0 0;}
.table tr th,.table tr td{text-align:left;font-size:12px;}
.table .lstBox tr td{border-bottom:1px solid #f1f1f1; padding:8px 5px; zoom:1; color:#666;}
.table .lstBox .wid220{width:220px;}
.table .lstBox .wid185{width:185px;}
.table .lstBox .wid150{width:150px;}
.table .lstBox .wid120{width:120px;}
.table .lstBox .wid110{width:110px;}
.table .lstBox .wid100{width:100px;}
.table .lstBox .wid80{width:80px;}
.table .lstBox .wid50{width:50px;}
.table .lstBox .wid40{width:40px;}
.table .lstBox .wid20{width:10px;}
.table .lstBox .time{color:#999;}
.table .lstBox b.name{line-height:44px; margin-left:10px;}
.table .lstBox a.name{line-height:44px; font-weight:bold; margin-left:10px;}
.table .lstBox a.name:link{color:#3d84b8;}
.table .lstBox a.name:visited{color:#800080;}
.table .lstBox a.name:hover,.table .lstBox a.name:active{color:#0af;}
.table .lstBox .Un{color:#999; font-weight:bold;margin-left:5px;}
.table .lstBox p.job{color:#444; font-weight:bold; width:110px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis; height:44px; line-height:44px;}
.table .lstBox .photo{background:url({/$siteurl.style/}/img/common/user35_44.jpg) no-repeat; width:35px; height:44px; border:0; display:block; float:left;}
.table .lstBox .photo a{width:35px; height:44px; display:block;}
.table .lstBox .photo img{width:35px; height:44px; border:0;}
.table .lstBox .mark a.hbFntWes{font-size:14px; color:#999; margin-left:10px;}
.table .lstBox .markIn a.hbFntWes{font-size:14px; color:#ed3136; margin-left:10px;}
.table .lstBox  p.lateJob{width:110px; line-height:44px; height:44px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;}
.table .lstBox .tips{position:relative; display:block;}
.table .lstBox .tips i.hbFntWes{font-size:16px; margin-left:5px;}
.table .lstBox .tipBox{position:absolute;left:-32px;*left:40px; top:21px;*top:4px; color:#444;background:#fff; border:1px solid #dadada; padding:5px 0;zoom:1; line-height:22px;}
.table .lstBox .tipBox ul li a{color:#444; width:85px; display:block; padding:0 10px;}
.table .lstBox .tipBox ul li a:hover{color:#00aaff; background:#f5f5f5;}
.table .lstBox .tipBox ul li.rLnk{position:relative; z-index:1;}
.table .lstBox .tipBox ul li.rLnk .downCmt{position:absolute; left:-28px; top:23px; background:#fff; border:1px solid #dadada; width:160px; font-size:12px;padding:10px; zoom:1;}
.table .lstBox .tipBox ul li.rLnk .downCmt i.hbIconMoon{font-size:14px; margin-right:5px;}
.table .lstBox .tipBox ul li.rLnk a.Un{cursor:text; color:#999;}
.table .lstBox .tipBox ul li.rLnk a.Un:hover{color:#999;}
.table .lstBox tr.hov{background:#fffdf3;}

.recBd .lst ul li.hov{border:1px solid #ffe0bb; background:#fffdf3;}
.recBd .lst ul li.hov .sumFt{background:#ffe0bb;}

.recBd .recBtn{padding:10px 5px; zoom:1; height:50px; line-height:50px; font-size:12px;}
.recBd .recBtn .formChb label{margin-top:9px;*margin-top:10px;}
.recBd .recBtn .formChb input.chb{margin-top:19px; _margin-top:0;#margin-top:14px;}
.recBd .recBtn .btns{display:block; float:left; _margin-top:8px;}
.recBd .recBtn .rec{margin:0 10px;}
.recBd .recBtn .ref{margin:0 10px;}

.noData a.btn1{ margin-top:30px;}
.noData a.btn{font-size:14px;}
.noData i.hbFntWes{font-size:14px; margin-right:5px;}
</style>
{/include 'nav.html' parent="网络招聘" cur='简历管理'/}
<div class="content" id="content">
	<section class="section">
		<hgroup>
                  <div class="postSchListBg">
                    <div class="postSchList">
                        <div class="zList">
                            <a href="{/get_url rule='/apply'/}"><span>收到的简历</span></a>
                            <a href="{/get_url rule='/download'/}" ><span>下载的简历</span></a>
                            <a href="{/get_url rule='/fav'/}" ><span>我的收藏</span></a>
                            <a href="{/get_url rule='/recommend'/}" ><span>推荐简历</span></a>
                            <a class="last cut" href="{/get_url rule='/recycle'/}" ><span>回收站</span></a>
                        </div>
                    </div>
                </div>
            <section class="noData" id="noDataArea" {/if $has_resume/}style="display:none;"{//if/}>
                <p>回收站里什么也没有</p>
            </section>
            {/if $has_resume/}
        	<div class="part part1" id="searchArea">
            	<div class="tipTxt">
                	<span class="num">共有<em id="recycle_count">{/$total_count/}</em>份简历</span>
                    {/if $show_filter/}
                    <a class="btn btnClearFilterSearch" href="#" style="margin-left:10px; font-size:12px;">
                        <i class="hbFntWes">&#xf014;</i>清空筛选/搜索条件
                    </a>
                    {//if/}
                </div>
                <div class="recHd">
                    <div class="recHdL">
                        <span class="seaBtn"><a href="#" class="btn2 btnsF12" id="btnClearAll">清空回收站</a></span>
                    </div>
                    <form id="frmRecycle" method="get" action="{/get_url rule="/recycle/Index/"/}" >
                        <input type="hidden" name="search_model" value="{/$search_model/}"  id="hddSeachModel"/>
                        <input type="hidden" name="show_model" value="{/$show_model/}"  id="hddShowModel"/>
                        <div class="recHdM">
                            <div class="tipTxt">筛选：</div>
                            <div class="conBox">
                            	<div class="from"><span id="tstDropFrom" class="drop zindex"></span></div>
                            </div>
                            <div class="clear"></div>
                        </div>
                        <div class="recHdR">
                            <div class="formMod">
                                <div class="l">搜索：</div>
                                <div class="r">
                                     <span class="formText"><input type="text" style="width:135px; font-size:12px;" class="text textGray" value="{/$keyword/}" name="keyword" id="txtKeyWord"></span>
                                     <span class="seaBtn"><a href="#" class="{/if $keyword==''/}btn3{/else/}btn1{//if/} btnsF12" id="btnResumeSearch">搜索</a></span>
                                </div>
                                <div class="clear"></div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="part part2">
                <div class="noData" id='noSearchData' {/if $hasFilter/}style='display:none'{//if/}>
                    <p>未找到相关简历，请更换筛选条件、关键词再试！</p>
                    <p>
                        <a class="btn btnClearFilterSearch" href="#">
                            <i class="hbFntWes">&#xf014;</i>清空筛选/搜索条件
                        </a>
                    </p>
                </div>
                {/if $hasFilter/}
                <div id="dataArea" class="recBd">
                    <div class="lstC">
                    	<div class="lstCon">
                            <div class="lst lst1" id="lst1">
                                <table class="table" cellpadding="0" cellspacing="0">
                                    <thead>
                                        <tr>
                                        	<th class="wid20"><span class="formChb"><input type="checkbox"  id="reverseallSelect" class="chb allSelect"></span></th>
                                            <th class="wid150">照片/姓名</th>
                                            <th class="wid40">备注</th>
                                            <th class="wid110">来源</th>
                                            <th class="wid50">性别</th>
                                            <th class="wid50">年龄</th>
                                            <th class="wid50">学历</th>
                                            <th class="wid100">工作年限</th>
                                            <th class="wid80">现居地</th>
                                            <th class="wid110">最近工作</th>
                                            <th class="wid80">操作</th>
                                        </tr>
                                    </thead>
                                    <tbody class="lstBox" id="lstContent">
                                    {/foreach $recyclesData as $key => $recycle/} 
                                        <tr data-recycle="{/$key/}">
                                        	<td class="wid20"><span class="formChb"><input type="checkbox" name="chkapply" class="chb opertions"></span></td>
                                            <td class="wid150">
                                                <span class="photo">{/if $recycle['small_photo']/}<img src="{/$recycle['small_photo']/}"/>{//if/}</span>
                                                <span class="name"><b class="name user_name">{/$recycle['user_name']/}</b></span>
                                            </td>
                                            <td class="wid40"><span class="hbTip mark {/if $recycle['remark']/}markIn{//if/}"><a href="#" class="hbFntWes" {/if $recycle['remark']/} data-toggle="tooltip" data-placement="right" title="{/$recycle['remark']/}" {/else/} data-placement="right"{//if/}>&#xf024;</a></span></td>
                                            <td class="wid110"><b>{/$recycle['origin_type']/}</p></td>
                                            <td class="wid50">{/$recycle['sex']/}</td>
                                            <td class="wid50">{/$recycle['age']/}</td>
                                            <td class="wid50">{/$recycle['degree']/}</td>
                                            <td class="wid80">{/$recycle['work_year']/}</td>
                                            <td class="wid100">{/$recycle['area']/}</td>
                                            <td class="wid110"><p class="lateJob">{/$recycle['work']/}</p></td>
                                            <td class="wid80">
                                                <span class="tips">
                                           	        <a href="#" class="oprecycle">恢复</a>
                                                </span>
                                            </td>
                                        </tr>
                                     {//foreach/}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="recBtn">
                            <span class="formChb"><input type="checkbox" name="deg" class="allSelect chb"><label for="allSelect">全选</label></span>
                            <span class="btns">
                                <a href="#" class="btn3 btnsF12" id="btnRecovery">恢复</a>
                                <a href="#" class="btn3 btnsF12" id="btnDelete">删除</a>
                            </span>
                        </div>
                    </div>
                    {/$pager/}
                </div> 
           		{//if/}
            </div>
            {//if/}
        </hgroup>
    </section>
</div>
{/include file="footer.html"/}

<script>
$.setIndex("zindex");//为需要赋层级设置的元素设置class为zindex
$('#tstDropFrom').droplist({
	defaultTitle:'按来源查看',
	style:'width:178px;',
    noSelectClass:'gray',
    inputWidth:170,
    width:128,
    hddName:'origin_id',
    items:{/$origintypes/},
    selectValue:'{/$origin_id/}',
    maxScroll:10,
    onSelect:function(i, name) {
	   	//选中后的事件
	   recycle.submit(0);	
}});

/**
 *  收到的简历
 */
var recycle = {
	init : function() {
		this._initEvent();
	},
	_initEvent : function(){
        var a = function() {
            var v = $('#txtKeyWord').val();
            if(v==''||v=="输入姓名或简历编号") {
                $('#btnResumeSearch').removeClass('btn1').addClass('btn3');
            }else{
                $('#btnResumeSearch').removeClass('btn3').addClass('btn1');
            }
            setTimeout(a,500);
        };
        setTimeout(a,500);

        $('#btnResumeSearch').on("click", function(){
             recycle.submit(1);
        });

        $("#txtKeyWord").on("keydown", function (e) {
            if (e.keyCode == 13) {
                $("#btnResumeSearch").click();
            }
        });

        $('#btnRecovery').on("click", function () {
            var checkboxes = $(".opertions:checked");
            if (checkboxes.length > 0) {
                var ids = new Array();
                checkboxes.each(function (i, e) {
                    ids.push($(this).closest("tr").data("recycle"));
                });
                recycle.recovery(ids.join(","));
            } else {
                $.anchor('请选择简历后再进行恢复',{icon:'warning'});
            }
        });

        $('#btnDelete').on("click", function () {
            var checkboxes = $(".opertions:checked");
            if (checkboxes.length > 0) {
                var ids = new Array();
                checkboxes.each(function (i, e) {
                    ids.push($(this).closest("tr").data("recycle"));
                });
                recycle.deleteresume(ids.join(","));
            } else {
                $.anchor('请选择简历后再进行删除',{icon:'warning'});
            }
        });

        $('.oprecycle').on("click", function(){
            var recycleId = $(this).closest("tr").data("recycle");
            if(typeof recycleId != 'undefined' && recycleId > 0) {
                recycle.recovery("" + recycleId);
            } else {
                $.anchor('请选择一个简历后再进行恢复',{icon:'warning'});
            }
        });

        $(".allSelect").on("click", function() {
            if ($(this).is(":checked")) {
                $("#lstContent").find("input[type='checkbox']").attr('checked', 'checked');
                $(".allSelect").attr('checked', 'checked');
            } else {
                $("#lstContent").find("input[type='checkbox']").removeAttr('checked', 'checked');
                $(".allSelect").removeAttr('checked', 'checked');
            }
        });

        $("#btnClearAll").on("click", function() {
            $.confirm("回收站内的数据将被全部删除，并且不能恢复，是否继续清空？", "清空回收站"   , function () {
                recycle.clearresume();
            });
        });

        // 清空筛选条件
        $('.btnClearFilterSearch').on("click", function(e) {
            $('#tstDropFrom').initContent();
            $('#txtKeyWord').val('').watermark('输入姓名或简历编号');
            recycle.submit(0);               
            e.preventDefault();
        });

        var a = function() {
            var v = $('#txtKeyWord').val();
            if(v==''||v=="输入姓名或简历编号") {
                $('#btnResumeSearch').removeClass('btn1').addClass('btn3');
            }else{
                $('#btnResumeSearch').removeClass('btn3').addClass('btn1');
            }
            setTimeout(a,500);
        };
        setTimeout(a,500);
        $('#txtKeyWord').watermark('输入姓名或简历编号');
    },
    recovery : function(ids) {
        $.getJSON('{/get_url rule="/recycle/recoverydo/" data="ids='+ids+'&v='+Math.random()+'"/}', function(result){
            if (result.success) {
                //删除列表
                window.location.reload();
            } else {
                $.anchorMsg(result.error, { icon: 'warning'}); 
            }
        });
    },
    removelisting : function(recycleid) {
        var $element = $('#lstContent').find('tr[data-recycle="'+recycleid+'"]');
        $element.remove();
        if ($('#lstContent').find('tr').length == 0) {
            $('#dataArea').remove();
            $('#noSearchData').show();
        }
    },
    submit : function(searchmodel) {
		if (searchmodel != null) {
			$('#hddSeachModel').val(searchmodel);
		}
		//清空水印 
		$('#frmRecycle').clearWatermark();	
		$('#frmRecycle').get(0).submit();	
    },
    deleteresume : function (ids) {
        $.getJSON('{/get_url rule="/recycle/delete/" data="ids='+ids+'&v='+Math.random()+'"/}', function(result){
            if (result.success) {
                $.anchorMsg('删除成功');
                setTimeout("window.location.reload()", 500);
            } else {
                $.anchorMsg(result.error, {icon: 'warning'}); 
            }
        });
    },
    clearresume : function () {
        $.getJSON('{/get_url rule="/recycle/clear"/}', function(result) {
            if (result.success) {
                $.anchorMsg('删除成功');
                setTimeout("window.location.reload()", 500);
            } else {
                $.anchorMsg(result.error, {icon: 'warning'}); 
            }
        });
    }
};
recycle.init();
</script>
</body>
</html>
